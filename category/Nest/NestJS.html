<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.9" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.43" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://studentdj.github.io/my-blob/category/Nest/NestJS.html"><meta property="og:site_name" content="æœˆå²›"><meta property="og:title" content="Nest JS å­¦ä¹ "><meta property="og:description" content="Nest JS å­¦ä¹  1ã€ä»‹ç» nestjs Nestjs æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºé«˜æ•ˆå¯æ‰©å±•çš„ä¸€ä¸ªåŸºäº Node js æœåŠ¡ç«¯ åº”ç”¨ç¨‹åºå¼€å‘æ¡†æ¶ å¹¶ä¸”å®Œå…¨æ”¯æŒ typeScript ç»“åˆäº† AOP é¢å‘åˆ‡é¢çš„ç¼–ç¨‹æ–¹å¼ nestjs è¿˜æ˜¯ä¸€ä¸ª spring MVC çš„é£æ ¼ å…¶ä¸­æœ‰ä¾èµ–æ³¨å…¥ IOC æ§åˆ¶åè½¬ éƒ½æ˜¯å€Ÿé‰´äº† Angualr nestjs çš„åº•å±‚ä»£ç è¿ç”¨..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-05-24T08:45:36.000Z"><meta property="article:author" content="æœˆå²›"><meta property="article:tag" content="Nest"><meta property="article:tag" content="Express"><meta property="article:published_time" content="2023-12-01T00:00:00.000Z"><meta property="article:modified_time" content="2024-05-24T08:45:36.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Nest JS å­¦ä¹ ","image":[""],"datePublished":"2023-12-01T00:00:00.000Z","dateModified":"2024-05-24T08:45:36.000Z","author":[{"@type":"Person","name":"æœˆå²›","url":"https://studentdj.github.io/my-blob/"}]}</script><title>Nest JS å­¦ä¹  | æœˆå²›</title><meta name="description" content="Nest JS å­¦ä¹  1ã€ä»‹ç» nestjs Nestjs æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºé«˜æ•ˆå¯æ‰©å±•çš„ä¸€ä¸ªåŸºäº Node js æœåŠ¡ç«¯ åº”ç”¨ç¨‹åºå¼€å‘æ¡†æ¶ å¹¶ä¸”å®Œå…¨æ”¯æŒ typeScript ç»“åˆäº† AOP é¢å‘åˆ‡é¢çš„ç¼–ç¨‹æ–¹å¼ nestjs è¿˜æ˜¯ä¸€ä¸ª spring MVC çš„é£æ ¼ å…¶ä¸­æœ‰ä¾èµ–æ³¨å…¥ IOC æ§åˆ¶åè½¬ éƒ½æ˜¯å€Ÿé‰´äº† Angualr nestjs çš„åº•å±‚ä»£ç è¿ç”¨...">
    <link rel="preload" href="/my-blob/assets/style-ClCXwzpS.css" as="style"><link rel="stylesheet" href="/my-blob/assets/style-ClCXwzpS.css">
    <link rel="modulepreload" href="/my-blob/assets/app-CEy8En57.js"><link rel="modulepreload" href="/my-blob/assets/NestJS.html-CbkTl7-0.js"><link rel="modulepreload" href="/my-blob/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/my-blob/assets/index.html-D4H2dCTw.js" as="script"><link rel="prefetch" href="/my-blob/assets/Electroné¡¹ç›®.html--lfmqkwT.js" as="script"><link rel="prefetch" href="/my-blob/assets/Mobx.html-DVsxRHRK.js" as="script"><link rel="prefetch" href="/my-blob/assets/ReactRouter.html-B4tPVZrf.js" as="script"><link rel="prefetch" href="/my-blob/assets/ReactåŸºç¡€.html-D2Pe_ToG.js" as="script"><link rel="prefetch" href="/my-blob/assets/å‰ç«¯å¸¸ç”¨æ–¹æ³•å°è£….html-CSVbJxFl.js" as="script"><link rel="prefetch" href="/my-blob/assets/å¤§æ–‡ä»¶ä¸Šä¼ .html-BfyHLXf9.js" as="script"><link rel="prefetch" href="/my-blob/assets/å¸¸è§ç®—æ³•é¢è¯•é¢˜.html-BY4Ci2ng.js" as="script"><link rel="prefetch" href="/my-blob/assets/æ— æ„Ÿåˆ·æ–°token.html-BNe6pQU5.js" as="script"><link rel="prefetch" href="/my-blob/assets/JavaåŸºç¡€.html-CU35xtOQ.js" as="script"><link rel="prefetch" href="/my-blob/assets/Javaè¿›é˜¶.html-C1k2HujR.js" as="script"><link rel="prefetch" href="/my-blob/assets/JavaWeb.html-CvOPvEpd.js" as="script"><link rel="prefetch" href="/my-blob/assets/Mysql.html-CihD8RWI.js" as="script"><link rel="prefetch" href="/my-blob/assets/404.html-JKFCAzLv.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-CSXIamSc.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-CgdnIBuZ.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-PleHTsmj.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-9MyQ44dd.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-CVnI0Hda.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-BmbNKa-i.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-DQMfV_km.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-DZpynlUZ.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-B3Smay9-.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-CtXp_Lov.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-Ct20Wwva.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-BR1P-UhA.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-Dt4VUduC.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-CJEl8A75.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-C6WtFVkw.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-ddaytlka.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-C7xzRWn0.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-Bo4QNiEl.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-DkEXt7MS.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-Dzs6JZ8x.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-BpTpD2rX.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-CtaEGQba.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-FcpREWUZ.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-Cu2BgBuu.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-CSwumK--.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-DiMGoe6r.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-ClAbMbJk.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-XW2n1fSW.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-ChlcNGf9.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-B21rTb3h.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-D3oYjXWR.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-CdfMKFFo.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-BugRH6cR.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-jXwjxtdF.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-BN_Wd15G.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-Bo0bBvfE.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-Bbpl4iOR.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-CYqFq4uL.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-DI35FYYR.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-COdl9zqb.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-mwEp8xza.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-BZ7T3_wi.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-DiLLrMcU.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-BDH1krcl.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-DXvHS5Rd.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-CVUMrARR.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-B5RxfK99.js" as="script"><link rel="prefetch" href="/my-blob/assets/index.html-BmbNKa-i.js" as="script"><link rel="prefetch" href="/my-blob/assets/photoswipe.esm-SzV8tJDW.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/my-blob/"><img class="vp-nav-logo" src="/my-blob/logo.jpg" alt><!----><span class="vp-site-name hide-in-pad">æœˆå²›</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link vp-link" href="/my-blob/" aria-label="åšå®¢ä¸»é¡µ"><span class="font-icon icon home" style=""></span>åšå®¢ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="å‰ç«¯"><!--[--><span class="font-icon icon react" style=""></span>å‰ç«¯<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">React</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/my-blob/JavaScript/React/React%E5%9F%BA%E7%A1%80.html" aria-label="ReactåŸºç¡€"><span class="font-icon icon react" style=""></span>ReactåŸºç¡€<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/my-blob/JavaScript/React/ReactRouter.html" aria-label="ReactRouter"><span class="font-icon icon react" style=""></span>ReactRouter<!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="åç«¯"><!--[--><span class="font-icon icon Java" style=""></span>åç«¯<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">Java</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link vp-link" href="/my-blob/category/Java/JavaSE/Java%E5%9F%BA%E7%A1%80.html" aria-label="JavaSE"><span class="font-icon icon Java" style=""></span>JavaSE<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">Nest</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link active vp-link" href="/my-blob/category/Nest/NestJS.html" aria-label="NeståŸºç¡€"><span class="font-icon icon Nest" style=""></span>NeståŸºç¡€<!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="route-link vp-link" href="/my-blob/Electron/" aria-label="Electronç³»åˆ—"><span class="font-icon icon app" style=""></span>Electronç³»åˆ—<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link vp-link" href="/my-blob/vite/" aria-label="Viteç³»åˆ—"><span class="font-icon icon tool" style=""></span>Viteç³»åˆ—<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link vp-link" href="/my-blob/timeline/" aria-label="æ—¶é—´è½´"><span class="font-icon icon time" style=""></span>æ—¶é—´è½´<!----></a></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/vuepress-theme-hope/vuepress-theme-hope" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/my-blob/" aria-label="åšå®¢ä¸»é¡µ"><span class="font-icon icon home" style=""></span>åšå®¢ä¸»é¡µ<!----></a></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header"><span class="font-icon icon react" style=""></span><span class="vp-sidebar-title">å‰ç«¯</span><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><p class="vp-sidebar-header"><!----><span class="vp-sidebar-title">React</span><!----></p><ul class="vp-sidebar-links"><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/my-blob/JavaScript/React/React%E5%9F%BA%E7%A1%80.html" aria-label="React"><span class="font-icon icon pen-to-square" style=""></span>React<!----></a></li><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/my-blob/JavaScript/React/ReactRouter.html" aria-label="ReactRouter"><span class="font-icon icon pen-to-square" style=""></span>ReactRouter<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header"><!----><span class="vp-sidebar-title">å…¶ä»–</span><!----></p><ul class="vp-sidebar-links"><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/my-blob/JavaScript/other/" aria-label="Other"><!---->Other<!----></a></li></ul></section></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header"><span class="font-icon icon react" style=""></span><span class="vp-sidebar-title">Electronç³»åˆ—</span><!----></p><ul class="vp-sidebar-links"><li><a class="route-link vp-link vp-sidebar-link vp-sidebar-page" href="/my-blob/Electron/Electron%E9%A1%B9%E7%9B%AE.html" aria-label="Electron é¡¹ç›®"><span class="font-icon icon pen-to-square" style=""></span>Electron é¡¹ç›®<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header active"><span class="font-icon icon Java" style=""></span><span class="vp-sidebar-title">åç«¯</span><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Java</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">Nest</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link active vp-link vp-sidebar-link vp-sidebar-page active" href="/my-blob/category/Nest/NestJS.html" aria-label="Nest JS å­¦ä¹ "><span class="font-icon icon pen-to-square" style=""></span>Nest JS å­¦ä¹ <!----></a></li></ul></section></li></ul></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><span class="font-icon icon pen-to-square" style=""></span>Nest JS å­¦ä¹ </h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://studentdj.github.io/my-blob/" target="_blank" rel="noopener noreferrer">æœˆå²›</a></span><span property="author" content="æœˆå²›"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-12-01T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 21 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT21M"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color2 clickable" role="navigation">Nest</span><!--]--><meta property="articleSection" content="Nest"></span><span class="page-tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color2 clickable" role="navigation">Nest</span><span class="page-tag-item color3 clickable" role="navigation">Express</span><!--]--><meta property="keywords" content="Nest,Express"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_1ã€ä»‹ç»-nestjs">1ã€ä»‹ç» nestjs</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#nestjs-å†…ç½®æ¡†æ¶-express-é»˜è®¤-express">nestjs å†…ç½®æ¡†æ¶ express é»˜è®¤ express</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#nestjs-å”¯äºŒå†…ç½®æ¡†æ¶-fastify">nestjs å”¯äºŒå†…ç½®æ¡†æ¶ Fastify</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2ã€ioc-æ§åˆ¶åè½¬-di-ä¾èµ–æ³¨å…¥">2ã€IOC æ§åˆ¶åè½¬ DI ä¾èµ–æ³¨å…¥</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_3ã€å‰ç½®çŸ¥è¯†è£…é¥°å™¨">3ã€å‰ç½®çŸ¥è¯†è£…é¥°å™¨</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1ã€ä»€ä¹ˆæ˜¯è£…é¥°å™¨">1ã€ä»€ä¹ˆæ˜¯è£…é¥°å™¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç±»è£…é¥°å™¨-ä¸»è¦æ˜¯é€šè¿‡-ç¬¦å·æ·»åŠ è£…é¥°å™¨">ç±»è£…é¥°å™¨ ä¸»è¦æ˜¯é€šè¿‡@ç¬¦å·æ·»åŠ è£…é¥°å™¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å±æ€§è£…é¥°å™¨">å±æ€§è£…é¥°å™¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‚æ•°è£…é¥°å™¨">å‚æ•°è£…é¥°å™¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ–¹æ³•è£…é¥°å™¨">æ–¹æ³•è£…é¥°å™¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®ç°ä¸€ä¸ª-get-è¯·æ±‚">å®ç°ä¸€ä¸ª GET è¯·æ±‚</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_4ã€nestjs-cli">4ã€nestjs cli</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_5ã€nestjs-cli-å¸¸ç”¨å‘½ä»¤">5ã€nestjs cli å¸¸ç”¨å‘½ä»¤</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#nest-help-å¯ä»¥æŸ¥çœ‹-nestjs-æ‰€æœ‰çš„å‘½ä»¤">nest --help å¯ä»¥æŸ¥çœ‹ nestjs æ‰€æœ‰çš„å‘½ä»¤</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_6ã€nestjs-æ§åˆ¶å™¨">6ã€nestjs æ§åˆ¶å™¨</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#controller-request-è·å–å‰ç«¯ä¼ è¿‡æ¥çš„å‚æ•°">Controller Request ï¼ˆè·å–å‰ç«¯ä¼ è¿‡æ¥çš„å‚æ•°ï¼‰</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_7ã€nestjs-æä¾›è€…">7ã€nestjs æä¾›è€…</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-åŸºæœ¬ç”¨æ³•">1.åŸºæœ¬ç”¨æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-service-ç¬¬äºŒç§ç”¨æ³•-è‡ªå®šä¹‰åç§°">2.service ç¬¬äºŒç§ç”¨æ³•(è‡ªå®šä¹‰åç§°)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-è‡ªå®šä¹‰æ³¨å…¥å€¼">3.è‡ªå®šä¹‰æ³¨å…¥å€¼</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_8ã€nestjs-ä¸Šä¼ å›¾ç‰‡-é™æ€ç›®å½•">8ã€nestjs ä¸Šä¼ å›¾ç‰‡-é™æ€ç›®å½•</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#nestjs-ä¸Šä¼ å›¾ç‰‡">Nestjs ä¸Šä¼ å›¾ç‰‡</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_9ã€nestjs-ä¸‹è½½å›¾ç‰‡">9ã€nestjs ä¸‹è½½å›¾ç‰‡</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-download-ç›´æ¥ä¸‹è½½">1.download ç›´æ¥ä¸‹è½½</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-ä½¿ç”¨æ–‡ä»¶æµçš„æ–¹å¼ä¸‹è½½">2.ä½¿ç”¨æ–‡ä»¶æµçš„æ–¹å¼ä¸‹è½½</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_10ã€nestjs-å’Œ-rxjs">10ã€nestjs å’Œ RxJs</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_11ã€nestjs-å“åº”æ‹¦æˆªå™¨">11ã€nestjs å“åº”æ‹¦æˆªå™¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_12ã€nestjs-å¼‚å¸¸æ‹¦æˆªå™¨">12ã€nestjs å¼‚å¸¸æ‹¦æˆªå™¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_13ã€nestjs-ç®¡é“è½¬æ¢">13ã€nestjs ç®¡é“è½¬æ¢</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ¡ˆä¾‹-1-æˆ‘ä»¬æ¥å—çš„åŠ¨æ€å‚æ•°å¸Œæœ›æ˜¯ä¸€ä¸ª-number-ç±»å‹-ç°åœ¨æ˜¯-string">æ¡ˆä¾‹ 1 æˆ‘ä»¬æ¥å—çš„åŠ¨æ€å‚æ•°å¸Œæœ›æ˜¯ä¸€ä¸ª number ç±»å‹ ç°åœ¨æ˜¯ string</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ¡ˆä¾‹-2-éªŒè¯-uuid">æ¡ˆä¾‹ 2 éªŒè¯ UUID</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_14ã€nestjs-ç®¡é“éªŒè¯-dto">14ã€nestjs ç®¡é“éªŒè¯ DTO</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-å…ˆåˆ›å»ºä¸€ä¸ª-pipe-éªŒè¯ç®¡é“">1.å…ˆåˆ›å»ºä¸€ä¸ª pipe éªŒè¯ç®¡é“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-å®‰è£…éªŒè¯å™¨">2.å®‰è£…éªŒè¯å™¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-controller-ä½¿ç”¨ç®¡é“-å’Œå®šä¹‰ç±»å‹">3.controller ä½¿ç”¨ç®¡é“ å’Œå®šä¹‰ç±»å‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-å®ç°éªŒè¯-transform">4.å®ç°éªŒè¯ transform</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-æ³¨å†Œå…¨å±€-dto-éªŒè¯ç®¡é“">5.æ³¨å†Œå…¨å±€ DTO éªŒè¯ç®¡é“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_15ã€nestjs-çˆ¬è™«">15ã€nestjs çˆ¬è™«</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_16ã€nestjs-è¿æ¥æ•°æ®åº“">16ã€nestjs è¿æ¥æ•°æ®åº“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_17ã€nestjs-å®ä½“">17ã€nestjs å®ä½“</a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h1 id="nest-js-å­¦ä¹ " tabindex="-1"><a class="header-anchor" href="#nest-js-å­¦ä¹ "><span>Nest JS å­¦ä¹ </span></a></h1><h2 id="_1ã€ä»‹ç»-nestjs" tabindex="-1"><a class="header-anchor" href="#_1ã€ä»‹ç»-nestjs"><span>1ã€ä»‹ç» nestjs</span></a></h2><p>Nestjs æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºé«˜æ•ˆå¯æ‰©å±•çš„ä¸€ä¸ªåŸºäº Node js æœåŠ¡ç«¯ åº”ç”¨ç¨‹åºå¼€å‘æ¡†æ¶</p><p>å¹¶ä¸”å®Œå…¨æ”¯æŒ typeScript ç»“åˆäº† AOP é¢å‘åˆ‡é¢çš„ç¼–ç¨‹æ–¹å¼</p><p>nestjs è¿˜æ˜¯ä¸€ä¸ª spring MVC çš„é£æ ¼ å…¶ä¸­æœ‰ä¾èµ–æ³¨å…¥ IOC æ§åˆ¶åè½¬ éƒ½æ˜¯å€Ÿé‰´äº† Angualr</p><p>nestjs çš„åº•å±‚ä»£ç è¿ç”¨äº† express å’Œ Fastify åœ¨ä»–ä»¬çš„åŸºç¡€ä¸Šæä¾›äº†ä¸€å®šç¨‹åº¦çš„æŠ½è±¡ï¼ŒåŒæ—¶ä¹Ÿå°†å…¶ API ç›´æ¥æš´éœ²ç»™å¼€å‘äººå‘˜ã€‚è¿™æ ·å¯ä»¥è½»æ¾ä½¿ç”¨æ¯ä¸ªå¹³å°çš„æ— æ•°ç¬¬ä¸‰æ–¹æ¨¡å—</p><p>nest js è‹±æ–‡å®˜ç½‘ <a href="https://nestjs.com/" target="_blank" rel="noopener noreferrer">NestJS - A progressive Node.js framework</a></p><p>nestjs ä¸­æ–‡ç½‘ <a href="https://nestjs.bootcss.com/" target="_blank" rel="noopener noreferrer">NestJS ç®€ä»‹ | NestJS ä¸­æ–‡æ–‡æ¡£ | NestJS ä¸­æ–‡ç½‘</a></p><p>nestjs ä¸­æ–‡ç½‘ 2 <a href="https://docs.nestjs.cn/" target="_blank" rel="noopener noreferrer">Nest.js ä¸­æ–‡æ–‡æ¡£</a></p><h3 id="nestjs-å†…ç½®æ¡†æ¶-express-é»˜è®¤-express" tabindex="-1"><a class="header-anchor" href="#nestjs-å†…ç½®æ¡†æ¶-express-é»˜è®¤-express"><span>nestjs å†…ç½®æ¡†æ¶ express é»˜è®¤ express</span></a></h3><p>èƒ½å¤Ÿå¿«é€Ÿæ„å»ºæœåŠ¡ç«¯åº”ç”¨ç¨‹åºï¼Œä¸”å­¦ä¹ æˆæœ¬éå¸¸ä½ï¼Œå®¹æ˜“ä¸Šæ‰‹</p><figure><img src="/my-blob/assets/express-BzpwqQP1.png" alt="01" tabindex="0" loading="lazy"><figcaption>01</figcaption></figure><p>express æ–‡æ¡£ <a href="https://www.expressjs.com.cn/" target="_blank" rel="noopener noreferrer">Express - åŸºäº Node.js å¹³å°çš„ web åº”ç”¨å¼€å‘æ¡†æ¶ - Express ä¸­æ–‡æ–‡æ¡£ | Express ä¸­æ–‡ç½‘</a></p><h3 id="nestjs-å”¯äºŒå†…ç½®æ¡†æ¶-fastify" tabindex="-1"><a class="header-anchor" href="#nestjs-å”¯äºŒå†…ç½®æ¡†æ¶-fastify"><span>nestjs å”¯äºŒå†…ç½®æ¡†æ¶ Fastify</span></a></h3><ul><li>é«˜æ€§èƒ½ï¼š æ®æˆ‘ä»¬æ‰€çŸ¥ï¼ŒFastify æ˜¯è¿™ä¸€é¢†åŸŸä¸­æœ€å¿«çš„ web æ¡†æ¶ä¹‹ä¸€ï¼Œå¦å¤–ï¼Œå–å†³äºä»£ç çš„å¤æ‚æ€§ï¼ŒFastify æœ€å¤šå¯ä»¥å¤„ç†æ¯ç§’ 3 ä¸‡æ¬¡çš„è¯·æ±‚ã€‚</li><li>å¯æ‰©å±•ï¼š Fastify é€šè¿‡å…¶æä¾›çš„é’©å­ï¼ˆhookï¼‰ã€æ’ä»¶å’Œè£…é¥°å™¨ï¼ˆdecoratorï¼‰æä¾›å®Œæ•´çš„å¯æ‰©å±•æ€§ã€‚</li><li>åŸºäº Schemaï¼š å³ä½¿è¿™ä¸æ˜¯å¼ºåˆ¶æ€§çš„ï¼Œæˆ‘ä»¬ä»å»ºè®®ä½¿ç”¨ JSON Schema æ¥åšè·¯ç”±ï¼ˆrouteï¼‰éªŒè¯åŠè¾“å‡ºå†…å®¹çš„åºåˆ—åŒ–ï¼ŒFastify åœ¨å†…éƒ¨å°† schema ç¼–è¯‘ä¸ºé«˜æ•ˆçš„å‡½æ•°å¹¶æ‰§è¡Œã€‚</li><li>æ—¥å¿—ï¼š æ—¥å¿—æ˜¯éå¸¸é‡è¦ä¸”ä»£ä»·é«˜æ˜‚çš„ã€‚æˆ‘ä»¬é€‰æ‹©äº†æœ€å¥½çš„æ—¥å¿—è®°å½•ç¨‹åºæ¥å°½é‡æ¶ˆé™¤è¿™ä¸€æˆæœ¬ï¼Œè¿™å°±æ˜¯ Pino!</li><li>å¯¹å¼€å‘äººå‘˜å‹å¥½ï¼š æ¡†æ¶çš„ä½¿ç”¨å¾ˆå‹å¥½ï¼Œå¸®åŠ©å¼€å‘äººå‘˜å¤„ç†æ—¥å¸¸å·¥ä½œï¼Œå¹¶ä¸”ä¸ç‰ºç‰²æ€§èƒ½å’Œå®‰å…¨æ€§ã€‚</li><li>æ”¯æŒ TypeScriptï¼š æˆ‘ä»¬åŠªåŠ›ç»´æŠ¤ä¸€ä¸ª TypeScript ç±»å‹å£°æ˜æ–‡ä»¶ï¼Œä»¥ä¾¿æ”¯æŒä¸æ–­æˆé•¿çš„ TypeScript ç¤¾åŒºã€‚</li></ul><h2 id="_2ã€ioc-æ§åˆ¶åè½¬-di-ä¾èµ–æ³¨å…¥" tabindex="-1"><a class="header-anchor" href="#_2ã€ioc-æ§åˆ¶åè½¬-di-ä¾èµ–æ³¨å…¥"><span>2ã€IOC æ§åˆ¶åè½¬ DI ä¾èµ–æ³¨å…¥</span></a></h2><p>åœ¨å­¦ä¹ <code>nestjs</code>ä¹‹å‰éœ€è¦å…ˆäº†è§£å…¶è®¾è®¡æ¨¡å¼</p><p>IOC</p><p>Inversion of Control å­—é¢æ„æ€æ˜¯<code>æ§åˆ¶åè½¬</code>ï¼Œå…·ä½“å®šä¹‰æ˜¯é«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–ä½å±‚æ¨¡å—ï¼ŒäºŒè€…éƒ½åº”è¯¥ä¾èµ–å…¶æŠ½è±¡ï¼›æŠ½è±¡ä¸åº”è¯¥ä¾èµ–ç»†èŠ‚ï¼›ç»†èŠ‚åº”è¯¥ä¾èµ–æŠ½è±¡ã€‚</p><p>DI</p><p>ä¾èµ–æ³¨å…¥ï¼ˆDependency Injectionï¼‰å…¶å®å’Œ IoC æ˜¯åŒæ ¹ç”Ÿï¼Œè¿™ä¸¤ä¸ªåŸæœ¬å°±æ˜¯ä¸€ä¸ªä¸œè¥¿ï¼Œåªä¸è¿‡ç”±äºæ§åˆ¶åè½¬æ¦‚å¿µæ¯”è¾ƒå«ç³Šï¼ˆå¯èƒ½åªæ˜¯ç†è§£ä¸ºå®¹å™¨æ§åˆ¶å¯¹è±¡è¿™ä¸€ä¸ªå±‚é¢ï¼Œå¾ˆéš¾è®©äººæƒ³åˆ°è°æ¥ç»´æŠ¤å¯¹è±¡å…³ç³»ï¼‰ï¼Œæ‰€ä»¥ 2004 å¹´å¤§å¸ˆçº§äººç‰© Martin Fowler åˆç»™å‡ºäº†ä¸€ä¸ªæ–°çš„åå­—ï¼šâ€œä¾èµ–æ³¨å…¥â€ã€‚ ç±» A ä¾èµ–ç±» B çš„å¸¸è§„è¡¨ç°æ˜¯åœ¨ A ä¸­ä½¿ç”¨ B çš„ instanceã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name"><span class="token constant">A</span></span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name"><span class="token constant">B</span></span> <span class="token punctuation">{</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  entity<span class="token operator">:</span> <span class="token constant">A</span><span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>entity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">A</span></span><span class="token punctuation">(</span><span class="token string">&quot;å¼ ä¸‰&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">B</span></span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

c<span class="token punctuation">.</span>entity<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ<strong>B</strong> ä¸­ä»£ç çš„å®ç°æ˜¯éœ€è¦ä¾èµ– <strong>A</strong> çš„ï¼Œ<strong>ä¸¤è€…çš„ä»£ç è€¦åˆåº¦éå¸¸é«˜ã€‚å½“ä¸¤è€…ä¹‹é—´çš„ä¸šåŠ¡é€»è¾‘å¤æ‚ç¨‹åº¦å¢åŠ çš„æƒ…å†µä¸‹ï¼Œç»´æŠ¤æˆæœ¬ä¸ä»£ç å¯è¯»æ€§éƒ½ä¼šéšç€å¢åŠ ï¼Œå¹¶ä¸”å¾ˆéš¾å†å¤šå¼•å…¥é¢å¤–çš„æ¨¡å—è¿›è¡ŒåŠŸèƒ½æ‹“å±•</strong>ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜å¯ä»¥ä½¿ç”¨ IOC å®¹å™¨</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name"><span class="token constant">A</span></span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name"><span class="token constant">C</span></span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//ä¸­é—´ä»¶ç”¨äºè§£è€¦</span>
<span class="token keyword">class</span> <span class="token class-name">Container</span> <span class="token punctuation">{</span>
  modeuls<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>modeuls <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">provide</span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> modeuls<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>modeuls<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> modeuls<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>modeuls<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> mo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mo<span class="token punctuation">.</span><span class="token function">provide</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">A</span></span><span class="token punctuation">(</span><span class="token string">&quot;å¼ ä¸‰1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mo<span class="token punctuation">.</span><span class="token function">provide</span><span class="token punctuation">(</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">C</span></span><span class="token punctuation">(</span><span class="token string">&quot;å¼ ä¸‰2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name"><span class="token constant">B</span></span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
  c<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>container<span class="token operator">:</span> Container<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>a <span class="token operator">=</span> container<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>c <span class="token operator">=</span> container<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">new</span> <span class="token class-name"><span class="token constant">B</span></span><span class="token punctuation">(</span>mo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…¶å®å°±æ˜¯å†™äº†ä¸€ä¸ªä¸­é—´ä»¶ï¼Œæ¥æ”¶é›†ä¾èµ–ï¼Œä¸»è¦æ˜¯ä¸ºäº†è§£è€¦ï¼Œå‡å°‘ç»´æŠ¤æˆæœ¬</p><h2 id="_3ã€å‰ç½®çŸ¥è¯†è£…é¥°å™¨" tabindex="-1"><a class="header-anchor" href="#_3ã€å‰ç½®çŸ¥è¯†è£…é¥°å™¨"><span>3ã€å‰ç½®çŸ¥è¯†è£…é¥°å™¨</span></a></h2><h3 id="_1ã€ä»€ä¹ˆæ˜¯è£…é¥°å™¨" tabindex="-1"><a class="header-anchor" href="#_1ã€ä»€ä¹ˆæ˜¯è£…é¥°å™¨"><span>1ã€ä»€ä¹ˆæ˜¯è£…é¥°å™¨</span></a></h3><p>è£…é¥°å™¨æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç±»å‹å£°æ˜ï¼Œä»–å¯ä»¥é™„åŠ åœ¨ç±»ï¼Œæ–¹æ³•ï¼Œå±æ€§ï¼Œå‚æ•°ä¸Šé¢</p><p>è£…é¥°å™¨å†™æ³• <strong>tipsï¼ˆéœ€è¦å¼€å¯ä¸€é¡¹é…ç½®ï¼‰</strong></p><figure><img src="/my-blob/assets/tips-ZFnIwaYy.png" alt="01" tabindex="0" loading="lazy"><figcaption>01</figcaption></figure><h3 id="ç±»è£…é¥°å™¨-ä¸»è¦æ˜¯é€šè¿‡-ç¬¦å·æ·»åŠ è£…é¥°å™¨" tabindex="-1"><a class="header-anchor" href="#ç±»è£…é¥°å™¨-ä¸»è¦æ˜¯é€šè¿‡-ç¬¦å·æ·»åŠ è£…é¥°å™¨"><span>ç±»è£…é¥°å™¨ ä¸»è¦æ˜¯é€šè¿‡@ç¬¦å·æ·»åŠ è£…é¥°å™¨</span></a></h3><p>ä»–ä¼šè‡ªåŠ¨æŠŠ class çš„æ„é€ å‡½æ•°ä¼ å…¥åˆ°è£…é¥°å™¨çš„ç¬¬ä¸€ä¸ªå‚æ•° target</p><p>ç„¶åé€šè¿‡ prototype å¯ä»¥è‡ªå®šä¹‰æ·»åŠ å±æ€§å’Œæ–¹æ³•</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">decotators</span><span class="token punctuation">(</span>target<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  target<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;å¼ ä¸‰&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">decotators</span></span>
<span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> user<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å±æ€§è£…é¥°å™¨" tabindex="-1"><a class="header-anchor" href="#å±æ€§è£…é¥°å™¨"><span>å±æ€§è£…é¥°å™¨</span></a></h3><p>åŒæ ·ä½¿ç”¨@ç¬¦å·ç»™å±æ€§æ·»åŠ è£…é¥°å™¨</p><p>ä»–ä¼šè¿”å›ä¸¤ä¸ªå‚æ•°</p><p>1.åŸå½¢å¯¹è±¡</p><p>2.å±æ€§çš„åç§°</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">const</span> currency<span class="token operator">:</span> <span class="token function-variable function">PropertyDecorator</span> <span class="token operator">=</span> <span class="token punctuation">(</span>target<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> key<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">symbol</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Xiaoman</span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">currency</span></span>
  <span class="token keyword">public</span> name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å‚æ•°è£…é¥°å™¨" tabindex="-1"><a class="header-anchor" href="#å‚æ•°è£…é¥°å™¨"><span>å‚æ•°è£…é¥°å™¨</span></a></h3><p>åŒæ ·ä½¿ç”¨@ç¬¦å·ç»™å±æ€§æ·»åŠ è£…é¥°å™¨</p><p>ä»–ä¼šè¿”å›ä¸¤ä¸ªå‚æ•°</p><p>1.åŸå½¢å¯¹è±¡</p><p>2.æ–¹æ³•çš„åç§°</p><p>3.å‚æ•°çš„ä½ç½®ä» 0 å¼€å§‹</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">const</span> currency<span class="token operator">:</span> <span class="token function-variable function">ParameterDecorator</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
  target<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span>
  key<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">symbol</span><span class="token punctuation">,</span>
  index<span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Xiaoman</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">getName</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">currency</span></span> age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ–¹æ³•è£…é¥°å™¨" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•è£…é¥°å™¨"><span>æ–¹æ³•è£…é¥°å™¨</span></a></h3><p>åŒæ ·ä½¿ç”¨@ç¬¦å·ç»™å±æ€§æ·»åŠ è£…é¥°å™¨</p><p>ä»–ä¼šè¿”å›ä¸¤ä¸ªå‚æ•°</p><p>1.åŸå½¢å¯¹è±¡</p><p>2.æ–¹æ³•çš„åç§°</p><p>3.å±æ€§æè¿°ç¬¦ å¯å†™å¯¹åº” writableï¼Œå¯æšä¸¾å¯¹åº” enumerableï¼Œå¯é…ç½®å¯¹åº” configurable</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">const</span> currency<span class="token operator">:</span> <span class="token function-variable function">MethodDecorator</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
  target<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span>
  key<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">symbol</span><span class="token punctuation">,</span>
  descriptor<span class="token operator">:</span> <span class="token builtin">any</span>
<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> descriptor<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Xiaoman</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">currency</span></span>
  <span class="token function">getName</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®ç°ä¸€ä¸ª-get-è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#å®ç°ä¸€ä¸ª-get-è¯·æ±‚"><span>å®ç°ä¸€ä¸ª GET è¯·æ±‚</span></a></h3><p>å®‰è£…ä¾èµ– npm install axios -S</p><p>å®šä¹‰æ§åˆ¶å™¨ Controller</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">Controller</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">getList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®šä¹‰è£…é¥°å™¨</p><p>è¿™æ—¶å€™éœ€è¦ä½¿ç”¨è£…é¥°å™¨å·¥å‚</p><p>åº”ä¸ºè£…é¥°å™¨é»˜è®¤ä¼šå¡å…¥ä¸€äº›å‚æ•°</p><p>å®šä¹‰ descriptor çš„ç±»å‹ é€šè¿‡ descriptor æè¿°ç¬¦é‡Œé¢çš„ value æŠŠ axios çš„ç»“æœè¿”å›ç»™å½“å‰ä½¿ç”¨è£…é¥°å™¨çš„å‡½æ•°</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">&quot;axios&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> Get <span class="token operator">=</span> <span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> MethodDecorator <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> descriptor<span class="token operator">:</span> PropertyDescriptor<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> fnc <span class="token operator">=</span> descriptor<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    axios
      <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">fnc</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token punctuation">{</span>
          status<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">fnc</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">{</span>
          status<span class="token operator">:</span> <span class="token number">500</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//å®šä¹‰æ§åˆ¶å™¨</span>
<span class="token keyword">class</span> <span class="token class-name">Controller</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&quot;https://api.apiopen.top/api/getHaoKanVideo?page=0&amp;size=10&quot;</span><span class="token punctuation">)</span>
  <span class="token function">getList</span><span class="token punctuation">(</span>res<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> status<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>result<span class="token punctuation">.</span>list<span class="token punctuation">,</span> status<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4ã€nestjs-cli" tabindex="-1"><a class="header-anchor" href="#_4ã€nestjs-cli"><span>4ã€nestjs cli</span></a></h2><h4 id="é€šè¿‡-cli-åˆ›å»º-nestjs-é¡¹ç›®" tabindex="-1"><a class="header-anchor" href="#é€šè¿‡-cli-åˆ›å»º-nestjs-é¡¹ç›®"><span>é€šè¿‡ cli åˆ›å»º nestjs é¡¹ç›®</span></a></h4><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>npm i <span class="token operator">-</span>g @nestjs<span class="token operator">/</span>cli

nest <span class="token keyword">new</span> <span class="token punctuation">[</span>é¡¹ç›®åç§°<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯åŠ¨é¡¹ç›® æˆ‘ä»¬éœ€è¦<code>çƒ­æ›´æ–°</code>å°±å¯åŠ¨ npm run start:dev å°±å¯ä»¥äº†</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>    <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token string">&quot;nest start&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;start:dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;nest start --watch&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;start:debug&quot;</span><span class="token operator">:</span> <span class="token string">&quot;nest start --debug --watch&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;start:prod&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node dist/main&quot;</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç›®å½•ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#ç›®å½•ä»‹ç»"><span>ç›®å½•ä»‹ç»</span></a></h4><p>1.main.ts å…¥å£æ–‡ä»¶ä¸»æ–‡ä»¶ ç±»ä¼¼äº vue çš„ main.ts</p><p>é€šè¿‡ NestFactory.create(AppModule) åˆ›å»ºä¸€ä¸ª app å°±æ˜¯ç±»ä¼¼äºç»‘å®šä¸€ä¸ªæ ¹ç»„ä»¶ App.vue</p><p>app.listen(3000); ç›‘å¬ä¸€ä¸ªç«¯å£</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> NestFactory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/core&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> AppModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./app.module&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">await</span> NestFactory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>AppModule<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2.Controller.ts æ§åˆ¶å™¨</p><p>ä½ å¯ä»¥ç†è§£æˆ vue çš„è·¯ç”±</p><p>private readonly appService: AppService è¿™ä¸€è¡Œä»£ç å°±æ˜¯ä¾èµ–æ³¨å…¥ä¸éœ€è¦å®ä¾‹åŒ– appService å®ƒå†…éƒ¨ä¼šè‡ªå·±å®ä¾‹åŒ–çš„æˆ‘ä»¬ä¸»éœ€è¦æ”¾ä¸Šå»å°±å¯ä»¥äº†</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> Get <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> AppService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./app.service&quot;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppController</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> <span class="token keyword">readonly</span> appService<span class="token operator">:</span> AppService<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">getHello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>appService<span class="token punctuation">.</span><span class="token function">getHello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//-----------------------------------------------------</span>
<span class="token comment">//ä¿®æ”¹åœ°å€ä¹‹å</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> Get <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> AppService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./app.service&quot;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">&quot;/get&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppController</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> <span class="token keyword">readonly</span> appService<span class="token operator">:</span> AppService<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">)</span>
  <span class="token function">getHello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>appService<span class="token punctuation">.</span><span class="token function">getHello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3.app.service.ts</p><p>è¿™ä¸ªæ–‡ä»¶ä¸»è¦å®ç°ä¸šåŠ¡é€»è¾‘çš„ å½“ç„¶ Controller å¯ä»¥å®ç°é€»è¾‘ï¼Œä½†æ˜¯å°±æ˜¯å•ä¸€çš„æ— æ³•å¤ç”¨ï¼Œæ”¾åˆ° app.service æœ‰åˆ«çš„æ¨¡å—ä¹Ÿéœ€è¦å°±å¯ä»¥å®ç°å¤ç”¨</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppService</span> <span class="token punctuation">{</span>
  <span class="token function">getHello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5ã€nestjs-cli-å¸¸ç”¨å‘½ä»¤" tabindex="-1"><a class="header-anchor" href="#_5ã€nestjs-cli-å¸¸ç”¨å‘½ä»¤"><span>5ã€nestjs cli å¸¸ç”¨å‘½ä»¤</span></a></h2><h3 id="nest-help-å¯ä»¥æŸ¥çœ‹-nestjs-æ‰€æœ‰çš„å‘½ä»¤" tabindex="-1"><a class="header-anchor" href="#nest-help-å¯ä»¥æŸ¥çœ‹-nestjs-æ‰€æœ‰çš„å‘½ä»¤"><span>nest --help å¯ä»¥æŸ¥çœ‹ nestjs æ‰€æœ‰çš„å‘½ä»¤</span></a></h3><figure><img src="/my-blob/assets/help-DueYI0_j.png" alt="03" tabindex="0" loading="lazy"><figcaption>03</figcaption></figure><h4 id="_1-ç”Ÿæˆ-controller-ts" tabindex="-1"><a class="header-anchor" href="#_1-ç”Ÿæˆ-controller-ts"><span>1.ç”Ÿæˆ controller.ts</span></a></h4><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>nest g co user
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_2-ç”Ÿæˆ-module-ts" tabindex="-1"><a class="header-anchor" href="#_2-ç”Ÿæˆ-module-ts"><span>2.ç”Ÿæˆ module.ts</span></a></h4><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>nest g mo user
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_3-ç”Ÿæˆ-service-ts" tabindex="-1"><a class="header-anchor" href="#_3-ç”Ÿæˆ-service-ts"><span>3.ç”Ÿæˆ service.ts</span></a></h4><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>nest g s user
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="ä»¥ä¸Šæ­¥éª¤ä¸€ä¸ªä¸€ä¸ªç”Ÿæˆçš„å¤ªæ…¢äº†æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸€ä¸ªå‘½ä»¤ç”Ÿæˆ-curd" tabindex="-1"><a class="header-anchor" href="#ä»¥ä¸Šæ­¥éª¤ä¸€ä¸ªä¸€ä¸ªç”Ÿæˆçš„å¤ªæ…¢äº†æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸€ä¸ªå‘½ä»¤ç”Ÿæˆ-curd"><span>ä»¥ä¸Šæ­¥éª¤ä¸€ä¸ªä¸€ä¸ªç”Ÿæˆçš„å¤ªæ…¢äº†æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸€ä¸ªå‘½ä»¤ç”Ÿæˆ CURD</span></a></h4><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code> nest g resource user
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="/my-blob/assets/CRUD-BdVYEVlC.png" alt="04" tabindex="0" loading="lazy"><figcaption>04</figcaption></figure><p><code>nest-cli.json</code>æ·»åŠ æ­¤é…ç½®ï¼Œä¸ä¼šç”Ÿæˆæµ‹è¯•æ–‡ä»¶</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;generateOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;spec&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_6ã€nestjs-æ§åˆ¶å™¨" tabindex="-1"><a class="header-anchor" href="#_6ã€nestjs-æ§åˆ¶å™¨"><span>6ã€nestjs æ§åˆ¶å™¨</span></a></h2><h3 id="controller-request-è·å–å‰ç«¯ä¼ è¿‡æ¥çš„å‚æ•°" tabindex="-1"><a class="header-anchor" href="#controller-request-è·å–å‰ç«¯ä¼ è¿‡æ¥çš„å‚æ•°"><span>Controller Request ï¼ˆè·å–å‰ç«¯ä¼ è¿‡æ¥çš„å‚æ•°ï¼‰</span></a></h3><p><code>nestjs</code>æä¾›äº†æ–¹æ³•å‚æ•°è£…é¥°å™¨ ç”¨æ¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿè·å–å‚æ•° å¦‚ä¸‹</p><table><thead><tr><th style="text-align:left;">@Request()</th><th>req</th></tr></thead><tbody><tr><td style="text-align:left;">@Response()</td><td>res</td></tr><tr><td style="text-align:left;">@Next()</td><td>next</td></tr><tr><td style="text-align:left;">@Session()</td><td>req.session</td></tr><tr><td style="text-align:left;">@Param(key?: string)</td><td>req.params<code>/</code>req.params[key]</td></tr><tr><td style="text-align:left;">@Body(key?: string)</td><td>req.body<code>/</code>req.body[key]</td></tr><tr><td style="text-align:left;">@Query(key?: string)</td><td>req.query<code>/</code>req.query[key]</td></tr><tr><td style="text-align:left;">@Headers(name?: string)</td><td>req.headers<code>/</code>req.headers[name]</td></tr><tr><td style="text-align:left;">@HttpCode</td><td></td></tr></tbody></table><h4 id="_1-è·å–-get-è¯·æ±‚ä¼ å‚" tabindex="-1"><a class="header-anchor" href="#_1-è·å–-get-è¯·æ±‚ä¼ å‚"><span>1.è·å– get è¯·æ±‚ä¼ å‚</span></a></h4><p>å¯ä»¥ä½¿ç”¨ Request è£…é¥°å™¨æˆ–è€… Query è£…é¥°å™¨ è·Ÿ express å®Œå…¨ä¸€æ ·</p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ Query ç›´æ¥è·å– ä¸éœ€è¦åœ¨é€šè¿‡ req.query äº†</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>
  Controller<span class="token punctuation">,</span>
  Get<span class="token punctuation">,</span>
  Post<span class="token punctuation">,</span>
  Body<span class="token punctuation">,</span>
  Patch<span class="token punctuation">,</span>
  Param<span class="token punctuation">,</span>
  Delete<span class="token punctuation">,</span>
  Version<span class="token punctuation">,</span>
  Request<span class="token punctuation">,</span>
  Query<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./user.service&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CreateUserDto <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./dto/create-user.dto&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UpdateUserDto <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./dto/update-user.dto&quot;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> <span class="token keyword">readonly</span> userService<span class="token operator">:</span> UserService<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">find</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Query</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> query<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> code<span class="token operator">:</span> <span class="token number">200</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-post-è·å–å‚æ•°" tabindex="-1"><a class="header-anchor" href="#_2-post-è·å–å‚æ•°"><span>2.post è·å–å‚æ•°</span></a></h4><p>å¯ä»¥ä½¿ç”¨ Request è£…é¥°å™¨ æˆ–è€… Body è£…é¥°å™¨ è·Ÿ express å®Œå…¨ä¸€æ ·</p><p>æˆ–è€…ç›´æ¥ä½¿ç”¨ Body è£…é¥°å™¨</p><p>ä¹Ÿå¯ä»¥ç›´æ¥è¯»å– key</p><figure><img src="/my-blob/assets/POST-B2k6d5N9.png" alt="05" tabindex="0" loading="lazy"><figcaption>05</figcaption></figure><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>
  Controller<span class="token punctuation">,</span>
  Get<span class="token punctuation">,</span>
  Post<span class="token punctuation">,</span>
  Body<span class="token punctuation">,</span>
  Patch<span class="token punctuation">,</span>
  Param<span class="token punctuation">,</span>
  Delete<span class="token punctuation">,</span>
  Version<span class="token punctuation">,</span>
  Request<span class="token punctuation">,</span>
  Query<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./user.service&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CreateUserDto <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./dto/create-user.dto&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UpdateUserDto <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./dto/update-user.dto&quot;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> <span class="token keyword">readonly</span> userService<span class="token operator">:</span> UserService<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">find</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Query</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> query<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> code<span class="token operator">:</span> <span class="token number">200</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Post</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">create</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Body</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> body<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      code<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-åŠ¨æ€è·¯ç”±" tabindex="-1"><a class="header-anchor" href="#_3-åŠ¨æ€è·¯ç”±"><span>3.åŠ¨æ€è·¯ç”±</span></a></h4><p>å¯ä»¥ä½¿ç”¨ Request è£…é¥°å™¨ æˆ–è€… Param è£…é¥°å™¨ è·Ÿ express å®Œå…¨ä¸€æ ·</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>
  Controller<span class="token punctuation">,</span>
  Get<span class="token punctuation">,</span>
  Post<span class="token punctuation">,</span>
  Body<span class="token punctuation">,</span>
  Patch<span class="token punctuation">,</span>
  Param<span class="token punctuation">,</span>
  Delete<span class="token punctuation">,</span>
  Version<span class="token punctuation">,</span>
  Request<span class="token punctuation">,</span>
  Query<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./user.service&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CreateUserDto <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./dto/create-user.dto&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UpdateUserDto <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./dto/update-user.dto&quot;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> <span class="token keyword">readonly</span> userService<span class="token operator">:</span> UserService<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">find</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Query</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> query<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> code<span class="token operator">:</span> <span class="token number">200</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Post</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">create</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Body</span></span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span> body<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      code<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&quot;:id&quot;</span><span class="token punctuation">)</span>
  <span class="token function">findId</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Param</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> param<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      code<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-è¯»å–-header-ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_4-è¯»å–-header-ä¿¡æ¯"><span>4.è¯»å– header ä¿¡æ¯</span></a></h4><p>æˆ‘åœ¨è°ƒè¯•å·¥å…·éšä¾¿åŠ äº†ä¸€ä¸ª cookie</p><figure><img src="/my-blob/assets/cookie-NDOvaFsr.png" alt="05" tabindex="0" loading="lazy"><figcaption>05</figcaption></figure><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>
  Controller<span class="token punctuation">,</span>
  Get<span class="token punctuation">,</span>
  Post<span class="token punctuation">,</span>
  Body<span class="token punctuation">,</span>
  Patch<span class="token punctuation">,</span>
  Param<span class="token punctuation">,</span>
  Delete<span class="token punctuation">,</span>
  Version<span class="token punctuation">,</span>
  Request<span class="token punctuation">,</span>
  Query<span class="token punctuation">,</span>
  Ip<span class="token punctuation">,</span>
  Header<span class="token punctuation">,</span>
  Headers<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./user.service&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CreateUserDto <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./dto/create-user.dto&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UpdateUserDto <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./dto/update-user.dto&quot;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> <span class="token keyword">readonly</span> userService<span class="token operator">:</span> UserService<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">find</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Query</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> query<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> code<span class="token operator">:</span> <span class="token number">200</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Post</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">create</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Body</span></span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span> body<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      code<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&quot;:id&quot;</span><span class="token punctuation">)</span>
  <span class="token function">findId</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Headers</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> header<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>header<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      code<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-çŠ¶æ€ç " tabindex="-1"><a class="header-anchor" href="#_5-çŠ¶æ€ç "><span>5.çŠ¶æ€ç </span></a></h4><p>ä½¿ç”¨ HttpCode è£…é¥°å™¨ æ§åˆ¶æ¥å£è¿”å›çš„çŠ¶æ€ç </p><figure><img src="/my-blob/assets/code-B_mo9XsN.png" alt="05" tabindex="0" loading="lazy"><figcaption>05</figcaption></figure><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>
  Controller<span class="token punctuation">,</span>
  Get<span class="token punctuation">,</span>
  Post<span class="token punctuation">,</span>
  Body<span class="token punctuation">,</span>
  Patch<span class="token punctuation">,</span>
  Param<span class="token punctuation">,</span>
  Delete<span class="token punctuation">,</span>
  Version<span class="token punctuation">,</span>
  Request<span class="token punctuation">,</span>
  Query<span class="token punctuation">,</span>
  Ip<span class="token punctuation">,</span>
  Header<span class="token punctuation">,</span>
  Headers<span class="token punctuation">,</span>
  HttpCode<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./user.service&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CreateUserDto <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./dto/create-user.dto&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UpdateUserDto <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./dto/update-user.dto&quot;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> <span class="token keyword">readonly</span> userService<span class="token operator">:</span> UserService<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">find</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Query</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> query<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> code<span class="token operator">:</span> <span class="token number">200</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Post</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">create</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Body</span></span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span> body<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      code<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&quot;:id&quot;</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">HttpCode</span></span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span>
  <span class="token function">findId</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Headers</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> header<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      code<span class="token operator">:</span> <span class="token number">500</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_7ã€nestjs-æä¾›è€…" tabindex="-1"><a class="header-anchor" href="#_7ã€nestjs-æä¾›è€…"><span>7ã€nestjs æä¾›è€…</span></a></h2><p>Providers<br> Providers æ˜¯ Nest çš„ä¸€ä¸ªåŸºæœ¬æ¦‚å¿µã€‚è®¸å¤šåŸºæœ¬çš„ Nest ç±»å¯èƒ½è¢«è§†ä¸º provider - service, repository, factory, helper ç­‰ç­‰ã€‚ ä»–ä»¬éƒ½å¯ä»¥é€šè¿‡ constructor æ³¨å…¥ä¾èµ–å…³ç³»ã€‚ è¿™æ„å‘³ç€å¯¹è±¡å¯ä»¥å½¼æ­¤åˆ›å»ºå„ç§å…³ç³»ï¼Œå¹¶ä¸”â€œè¿æ¥â€å¯¹è±¡å®ä¾‹çš„åŠŸèƒ½åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå¯ä»¥å§”æ‰˜ç»™ Nest è¿è¡Œæ—¶ç³»ç»Ÿã€‚ Provider åªæ˜¯ä¸€ä¸ªç”¨ @Injectable() è£…é¥°å™¨æ³¨é‡Šçš„ç±»ã€‚</p><h3 id="_1-åŸºæœ¬ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#_1-åŸºæœ¬ç”¨æ³•"><span>1.åŸºæœ¬ç”¨æ³•</span></a></h3><p>module å¼•å…¥ service åœ¨ providers æ³¨å…¥</p><figure><img src="/my-blob/assets/7.1-BUnCWD66.png" alt="06" tabindex="0" loading="lazy"><figcaption>06</figcaption></figure><p>åœ¨ Controller å°±å¯ä»¥ä½¿ç”¨æ³¨å…¥å¥½çš„ service äº†</p><figure><img src="/my-blob/assets/7.1-BUnCWD66.png" alt="06" tabindex="0" loading="lazy"><figcaption>06</figcaption></figure><h3 id="_2-service-ç¬¬äºŒç§ç”¨æ³•-è‡ªå®šä¹‰åç§°" tabindex="-1"><a class="header-anchor" href="#_2-service-ç¬¬äºŒç§ç”¨æ³•-è‡ªå®šä¹‰åç§°"><span>2.service ç¬¬äºŒç§ç”¨æ³•(è‡ªå®šä¹‰åç§°)</span></a></h3><p>ç¬¬ä¸€ç§ç”¨æ³•å°±æ˜¯ä¸€ä¸ª<a href="https://so.csdn.net/so/search?q=%E8%AF%AD%E6%B3%95%E7%B3%96&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreferrer">è¯­æ³•ç³–</a></p><p>å…¶å®ä»–çš„å…¨ç§°æ˜¯è¿™æ ·çš„</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./user.service&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./user.controller&quot;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Module</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  controllers<span class="token operator">:</span> <span class="token punctuation">[</span>UserController<span class="token punctuation">]</span><span class="token punctuation">,</span>
  providers<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      provide<span class="token operator">:</span> <span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span>
      useClass<span class="token operator">:</span> UserService<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è‡ªå®šä¹‰åç§°ä¹‹å éœ€è¦ç”¨å¯¹åº”çš„ Inject å– ä¸ç„¶ä¼šæ‰¾ä¸åˆ°çš„</p><h3 id="_3-è‡ªå®šä¹‰æ³¨å…¥å€¼" tabindex="-1"><a class="header-anchor" href="#_3-è‡ªå®šä¹‰æ³¨å…¥å€¼"><span>3.è‡ªå®šä¹‰æ³¨å…¥å€¼</span></a></h3><p>é€šè¿‡ useValue</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./user.service&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./user.controller&quot;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Module</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  controllers<span class="token operator">:</span> <span class="token punctuation">[</span>UserController<span class="token punctuation">]</span><span class="token punctuation">,</span>
  providers<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      provide<span class="token operator">:</span> <span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span>
      useClass<span class="token operator">:</span> UserService<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      provide<span class="token operator">:</span> <span class="token string">&quot;JD&quot;</span><span class="token punctuation">,</span>
      useValue<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;TB&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;PDD&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;JD&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-å·¥å‚æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#_3-å·¥å‚æ¨¡å¼"><span>3.å·¥å‚æ¨¡å¼</span></a></h4><p>å¦‚æœæœåŠ¡ ä¹‹é—´æœ‰ç›¸äº’çš„ä¾èµ– æˆ–è€…é€»è¾‘å¤„ç† å¯ä»¥ä½¿ç”¨ useFactory</p><div class="language-TypeScript line-numbers-mode" data-ext="TypeScript" data-title="TypeScript"><pre class="language-TypeScript"><code>import { Module } from &#39;@nestjs/common&#39;;
import { UserService } from &#39;./user.service&#39;;
import { UserService2 } from &#39;./user.service2&#39;;
import { UserService3 } from &#39;./user.service3&#39;;
import { UserController } from &#39;./user.controller&#39;;

@Module({
  controllers: [UserController],
  providers: [{
    provide: &quot;user&quot;,
    useClass: UserService
  }, {
    provide: &quot;JD&quot;,
    useValue: [&#39;TB&#39;, &#39;PDD&#39;, &#39;JD&#39;]
  },
    UserService2,
  {
    provide: &quot;Test&quot;,
    inject: [UserService2],
    useFactory(UserService2: UserService2) {
      return new UserService3(UserService2)
    }
  }
  ]
})
export class UserModule { }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-å¼‚æ­¥æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#_4-å¼‚æ­¥æ¨¡å¼"><span>4.å¼‚æ­¥æ¨¡å¼</span></a></h4><p>useFactory è¿”å›ä¸€ä¸ª promise æˆ–è€…å…¶ä»–å¼‚æ­¥æ“ä½œ</p><div class="language-TypeScript line-numbers-mode" data-ext="TypeScript" data-title="TypeScript"><pre class="language-TypeScript"><code>import { Module } from &#39;@nestjs/common&#39;;
import { UserService } from &#39;./user.service&#39;;
import { UserService2 } from &#39;./user.service2&#39;;
import { UserService3 } from &#39;./user.service3&#39;;
import { UserController } from &#39;./user.controller&#39;;

@Module({
  controllers: [UserController],
  providers: [{
    provide: &quot;user&quot;,
    useClass: UserService
  }, {
    provide: &quot;JD&quot;,
    useValue: [&#39;TB&#39;, &#39;PDD&#39;, &#39;JD&#39;]
  },
    UserService2,
  {
    provide: &quot;Test&quot;,
    inject: [UserService2],
    useFactory(UserService2: UserService2) {
      return new UserService3(UserService2)
    }
  },
  {
    provide: &quot;sync&quot;,
    async useFactory() {
      return await  new Promise((r) =&gt; {
        setTimeout(() =&gt; {
          r(&#39;sync&#39;)
        }, 3000)
      })
    }
  }
  ]
})
export class UserModule { }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_8ã€nestjs-ä¸Šä¼ å›¾ç‰‡-é™æ€ç›®å½•" tabindex="-1"><a class="header-anchor" href="#_8ã€nestjs-ä¸Šä¼ å›¾ç‰‡-é™æ€ç›®å½•"><span>8ã€nestjs ä¸Šä¼ å›¾ç‰‡-é™æ€ç›®å½•</span></a></h2><h3 id="nestjs-ä¸Šä¼ å›¾ç‰‡" tabindex="-1"><a class="header-anchor" href="#nestjs-ä¸Šä¼ å›¾ç‰‡"><span>Nestjs ä¸Šä¼ å›¾ç‰‡</span></a></h3><h4 id="_1-ä¸»è¦ä¼šç”¨åˆ°ä¸¤ä¸ªåŒ…" tabindex="-1"><a class="header-anchor" href="#_1-ä¸»è¦ä¼šç”¨åˆ°ä¸¤ä¸ªåŒ…"><span>1.ä¸»è¦ä¼šç”¨åˆ°ä¸¤ä¸ªåŒ…</span></a></h4><p>multer @nestjs/platform-express <strong>nestJs è‡ªå¸¦äº†</strong></p><p>multer @types/multer è¿™ä¸¤ä¸ªéœ€è¦å®‰è£…</p><p>åœ¨ upload Module ä½¿ç”¨ MulterModule register æ³¨å†Œå­˜æ”¾å›¾ç‰‡çš„ç›®å½•</p><p>éœ€è¦ç”¨åˆ° multer çš„ diskStorage è®¾ç½®å­˜æ”¾ç›®å½• extname ç”¨æ¥è¯»å–æ–‡ä»¶åç¼€ filename ç»™æ–‡ä»¶é‡æ–°å‘½å</p><p><mark>upload.module.ts æ–‡ä»¶</mark></p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UploadService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./upload.service&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UploadController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./upload.controller&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// å¼•å…¥</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> MulterModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/platform-express&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> diskStorage <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;multer&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> extname<span class="token punctuation">,</span> join <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;path&quot;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Module</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  imports<span class="token operator">:</span> <span class="token punctuation">[</span>
    MulterModule<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      storage<span class="token operator">:</span> <span class="token function">diskStorage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token comment">// è®¾ç½®æ–‡ä»¶ä¿å­˜çš„è·¯å¾„</span>
        destination<span class="token operator">:</span> <span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../images&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function-variable function">filename</span><span class="token operator">:</span> <span class="token punctuation">(</span>_<span class="token punctuation">,</span> file<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token comment">// å®šä¹‰ä¿å­˜çš„æ–‡ä»¶å</span>
          <span class="token keyword">const</span> fileName <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>
            <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">extname</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span>originalname<span class="token punctuation">)</span>
          <span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
          <span class="token comment">// æŠ›å‡º</span>
          <span class="token keyword">return</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> fileName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  controllers<span class="token operator">:</span> <span class="token punctuation">[</span>UploadController<span class="token punctuation">]</span><span class="token punctuation">,</span>
  providers<span class="token operator">:</span> <span class="token punctuation">[</span>UploadService<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UploadModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-controller-ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#_2-controller-ä½¿ç”¨"><span>2.controller ä½¿ç”¨</span></a></h4><p>ä½¿ç”¨ <code>UseInterceptors</code> è£…é¥°å™¨<code>FileInterceptor</code>æ˜¯å•ä¸ª <code>FilesInterceptor</code>æ˜¯å¤šä¸ª</p><p>å‚æ•° ä½¿ç”¨ <code>UploadedFile</code> è£…é¥°å™¨æ¥å— file æ–‡ä»¶</p><p><mark>upload.controller.ts æ–‡ä»¶</mark></p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>
  Controller<span class="token punctuation">,</span>
  Post<span class="token punctuation">,</span>
  UseInterceptors<span class="token punctuation">,</span>
  UploadedFile<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UploadService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./upload.service&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> FileInterceptor <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/platform-express&quot;</span><span class="token punctuation">;</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">&quot;upload&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UploadController</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> <span class="token keyword">readonly</span> uploadService<span class="token operator">:</span> UploadService<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Post</span></span><span class="token punctuation">(</span><span class="token string">&quot;album&quot;</span><span class="token punctuation">)</span>
  <span class="token comment">// é…ç½®å‚æ•°åç§°</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">UseInterceptors</span></span><span class="token punctuation">(</span><span class="token function">FileInterceptor</span><span class="token punctuation">(</span><span class="token string">&quot;file&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token function">upload</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">UploadedFile</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> file<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      code<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
      msg<span class="token operator">:</span> <span class="token string">&quot;ä¸Šä¼ æˆåŠŸ&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-å¦‚æœæƒ³è¦ç”Ÿæˆé™æ€ç›®å½•-å¹¶ä¸”è®¿é—®ä¸Šä¼ ä¹‹åçš„å›¾ç‰‡" tabindex="-1"><a class="header-anchor" href="#_3-å¦‚æœæƒ³è¦ç”Ÿæˆé™æ€ç›®å½•-å¹¶ä¸”è®¿é—®ä¸Šä¼ ä¹‹åçš„å›¾ç‰‡"><span>3.å¦‚æœæƒ³è¦ç”Ÿæˆé™æ€ç›®å½•ï¼Œå¹¶ä¸”è®¿é—®ä¸Šä¼ ä¹‹åçš„å›¾ç‰‡</span></a></h4><p><mark>main.ts æ–‡ä»¶</mark></p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> NestFactory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/core&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> AppModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./app.module&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// é…ç½®é™æ€è®¿é—®çš„è·¯ç”±</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> NestExpressApplication <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/platform-express&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> join <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;path&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">await</span> NestFactory<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">create</span><span class="token generic class-name"><span class="token operator">&lt;</span>NestExpressApplication<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>AppModule<span class="token punctuation">)</span><span class="token punctuation">;</span>
  app<span class="token punctuation">.</span><span class="token function">useStaticAssets</span><span class="token punctuation">(</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;images&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    prefix<span class="token operator">:</span> <span class="token string">&quot;/images&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_9ã€nestjs-ä¸‹è½½å›¾ç‰‡" tabindex="-1"><a class="header-anchor" href="#_9ã€nestjs-ä¸‹è½½å›¾ç‰‡"><span>9ã€nestjs ä¸‹è½½å›¾ç‰‡</span></a></h2><p>ä¸‹è½½æ–‡ä»¶çš„æ–¹å¼æœ‰å¥½å¤šç§</p><h3 id="_1-download-ç›´æ¥ä¸‹è½½" tabindex="-1"><a class="header-anchor" href="#_1-download-ç›´æ¥ä¸‹è½½"><span>1.download ç›´æ¥ä¸‹è½½</span></a></h3><p>è¿™ä¸ªæ–‡ä»¶ä¿¡æ¯åº”è¯¥å­˜æ•°æ®åº“ è¿™å„¿æ¼”ç¤ºå°±å†™æ­» äº†</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>
  Controller<span class="token punctuation">,</span>
  Post<span class="token punctuation">,</span>
  Get<span class="token punctuation">,</span>
  UseInterceptors<span class="token punctuation">,</span>
  UploadedFile<span class="token punctuation">,</span>
  Res<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UploadService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./upload.service&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> FileInterceptor <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/platform-express&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> Response <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;express&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> join <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;path&quot;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">&quot;upload&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UploadController</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> <span class="token keyword">readonly</span> uploadService<span class="token operator">:</span> UploadService<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token doc-comment comment">/**
   * ä¸Šä¼ å›¾ç‰‡
   * <span class="token keyword">@param</span> <span class="token parameter">file</span>
   */</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Post</span></span><span class="token punctuation">(</span><span class="token string">&quot;album&quot;</span><span class="token punctuation">)</span>
  <span class="token comment">// é…ç½®å‚æ•°åç§°</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">UseInterceptors</span></span><span class="token punctuation">(</span><span class="token function">FileInterceptor</span><span class="token punctuation">(</span><span class="token string">&quot;file&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token function">upload</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">UploadedFile</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> file<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      code<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
      msg<span class="token operator">:</span> <span class="token string">&quot;ä¸Šä¼ æˆåŠŸ&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token doc-comment comment">/**
   * ä¸‹è½½å›¾ç‰‡
   * <span class="token keyword">@param</span> <span class="token parameter">res</span>
   */</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&quot;export&quot;</span><span class="token punctuation">)</span>
  <span class="token function">downLoad</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Res</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> res<span class="token operator">:</span> Response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../images/1701956065902.png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// res</span>
    <span class="token comment">// console.log(url)</span>
    res<span class="token punctuation">.</span><span class="token function">download</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// return  true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-ä½¿ç”¨æ–‡ä»¶æµçš„æ–¹å¼ä¸‹è½½" tabindex="-1"><a class="header-anchor" href="#_2-ä½¿ç”¨æ–‡ä»¶æµçš„æ–¹å¼ä¸‹è½½"><span>2.ä½¿ç”¨æ–‡ä»¶æµçš„æ–¹å¼ä¸‹è½½</span></a></h3><p>å¯ä»¥ä½¿ç”¨ compressing æŠŠä»–å‹ç¼©æˆä¸€ä¸ª zip åŒ…</p><p>import {zip} from &#39;compressing&#39;</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&#39;stream&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token function">down</span> <span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Res</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> res<span class="token operator">:</span>Response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">&#39;../images/1662894316133.png&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> tarStream  <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">zip</span><span class="token punctuation">.</span><span class="token function">Stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">await</span> tarStream<span class="token punctuation">.</span><span class="token function">addEntry</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>

    res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&#39;Content-Type&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;application/octet-stream&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span>
        <span class="token string">&#39;Content-Disposition&#39;</span><span class="token punctuation">,</span>
        <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">attachment; filename=genshen</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    tarStream<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å‰ç«¯æ¥å—æµ</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">const</span> <span class="token function-variable function">useFetch</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span><span class="token function">arrayBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> a <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  a<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>
    <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>res<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token comment">// type:&quot;image/png&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  a<span class="token punctuation">.</span>download <span class="token operator">=</span> <span class="token string">&quot;file.zip&quot;</span><span class="token punctuation">;</span>
  a<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">download</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">useFetch</span><span class="token punctuation">(</span><span class="token string">&quot;http://localhost:3000/upload/stream&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_10ã€nestjs-å’Œ-rxjs" tabindex="-1"><a class="header-anchor" href="#_10ã€nestjs-å’Œ-rxjs"><span>10ã€nestjs å’Œ RxJs</span></a></h2><p>æ¦‚å¿µ<br> RxJs ä½¿ç”¨çš„æ˜¯è§‚å¯Ÿè€…æ¨¡å¼ï¼Œç”¨æ¥ç¼–å†™å¼‚æ­¥é˜Ÿåˆ—å’Œäº‹ä»¶å¤„ç†ã€‚</p><p>Observable å¯è§‚å¯Ÿçš„ç‰©ä»¶</p><p>Subscription ç›‘å¬ Observable</p><p>Operators çº¯å‡½æ•°å¯ä»¥å¤„ç†ç®¡é“çš„æ•°æ® å¦‚ map filter concat reduce ç­‰</p><p>æ¡ˆä¾‹<br> ç±»ä¼¼äºè¿­ä»£å™¨ next å‘å‡ºé€šçŸ¥ complete é€šçŸ¥å®Œæˆ</p><p>subscribe è®¢é˜… observable å‘å‡ºçš„é€šçŸ¥ ä¹Ÿå°±æ˜¯ä¸€ä¸ªè§‚å¯Ÿè€…</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Observable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;rxjs&quot;</span><span class="token punctuation">;</span>

<span class="token comment">//ç±»ä¼¼äºè¿­ä»£å™¨ next å‘å‡ºé€šçŸ¥  completeé€šçŸ¥å®Œæˆ</span>
<span class="token keyword">const</span> observable <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Observable</span><span class="token punctuation">(</span><span class="token punctuation">(</span>subscriber<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  subscriber<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  subscriber<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  subscriber<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    subscriber<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    subscriber<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

observable<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">next</span><span class="token operator">:</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¡ˆä¾‹ 2</p><p>interval äº”ç™¾æ¯«ç§’æ‰§è¡Œä¸€æ¬¡ pipe å°±æ˜¯ç®¡é“çš„æ„æ€ ç®¡é“é‡Œé¢ä¹Ÿæ˜¯å¯ä»¥å»æ‰æ¥å£çš„æ”¯æŒå¤„ç†å¼‚æ­¥æ•°æ® å»å¤„ç†æ•°æ® è¿™å„¿å±•ç¤º äº† map å’Œ filter è·Ÿæ•°ç»„çš„æ–¹æ³•æ˜¯ä¸€æ ·çš„ æœ€å é€šè¿‡è§‚å¯Ÿè€… subscribe æ¥å—å›è°ƒ</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Observable<span class="token punctuation">,</span> interval<span class="token punctuation">,</span> take <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;rxjs&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> map<span class="token punctuation">,</span> filter<span class="token punctuation">,</span> reduce<span class="token punctuation">,</span> find<span class="token punctuation">,</span> findIndex <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;rxjs/operators&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> subs <span class="token operator">=</span> <span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
    <span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> num<span class="token operator">:</span> v <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> v<span class="token punctuation">.</span>num <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>num <span class="token operator">==</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      subs<span class="token punctuation">.</span><span class="token function">unsubscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¡ˆä¾‹ 3</p><p>Rxjs ä¹Ÿå¯ä»¥å¤„ç†äº‹ä»¶ ä¸è¿‡æˆ‘ä»¬åœ¨ Nestjs é‡Œé¢å°±ä¸ç”¨æ“ä½œ DOM äº† ä½ å¦‚æœ Angular æˆ–åˆ™ Vue æ¡†æ¶çœ‹å¯ä»¥ä½¿ç”¨ fromEvent</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Observable<span class="token punctuation">,</span> interval<span class="token punctuation">,</span> take<span class="token punctuation">,</span> <span class="token keyword">of</span><span class="token punctuation">,</span> retry<span class="token punctuation">,</span> fromEvent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;rxjs&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> map<span class="token punctuation">,</span> filter<span class="token punctuation">,</span> reduce<span class="token punctuation">,</span> find<span class="token punctuation">,</span> findIndex <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;rxjs/operators&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> dom <span class="token operator">=</span> <span class="token function">fromEvent</span><span class="token punctuation">(</span>document<span class="token punctuation">,</span> <span class="token string">&quot;click&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> e<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dom<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_11ã€nestjs-å“åº”æ‹¦æˆªå™¨" tabindex="-1"><a class="header-anchor" href="#_11ã€nestjs-å“åº”æ‹¦æˆªå™¨"><span>11ã€nestjs å“åº”æ‹¦æˆªå™¨</span></a></h2><p>æ‹¦æˆªå™¨<br> æ‹¦æˆªå™¨å…·æœ‰ä¸€ç³»åˆ—æœ‰ç”¨çš„åŠŸèƒ½ï¼Œè¿™äº›åŠŸèƒ½å—é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰æŠ€æœ¯çš„å¯å‘ã€‚å®ƒä»¬å¯ä»¥ï¼š</p><ul><li>åœ¨å‡½æ•°æ‰§è¡Œä¹‹å‰/ä¹‹åç»‘å®šé¢å¤–çš„é€»è¾‘</li><li>è½¬æ¢ä»å‡½æ•°è¿”å›çš„ç»“æœ</li><li>è½¬æ¢ä»å‡½æ•°æŠ›å‡ºçš„å¼‚å¸¸</li><li>æ‰©å±•åŸºæœ¬å‡½æ•°è¡Œä¸º</li><li>æ ¹æ®æ‰€é€‰æ¡ä»¶å®Œå…¨é‡å†™å‡½æ•° (ä¾‹å¦‚, ç¼“å­˜ç›®çš„)</li><li>æˆ‘ä»¬ç°åœ¨æ²¡æœ‰ç»™æˆ‘ä»¬çš„ Nestjs è§„èŒƒè¿”å›ç»™å‰ç«¯çš„æ ¼å¼ç°åœ¨æ¯”è¾ƒä¹±</li></ul><p>æˆ‘ä»¬æƒ³ç»™ä»–è¿”å›ä¸€ä¸ªæ ‡å‡†çš„ json æ ¼å¼ å°±è¦ç»™æˆ‘ä»¬çš„æ•°æ®åšä¸€ä¸ªå…¨å±€ format</p><div class="language-cobol line-numbers-mode" data-ext="cobol" data-title="cobol"><pre class="language-cobol"><code>{
  <span class="token keyword">data</span><span class="token punctuation">,</span> <span class="token operator">/</span><span class="token operator">/</span>æ•°æ®
  <span class="token keyword">status</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token keyword">message</span><span class="token punctuation">:</span><span class="token string">&quot;æˆåŠŸ&quot;</span><span class="token punctuation">,</span>
  success<span class="token punctuation">:</span><span class="token boolean">true</span>
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ–°å»º common æ–‡ä»¶å¤¹ åˆ›å»º response.ts</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable<span class="token punctuation">,</span> NestInterceptor<span class="token punctuation">,</span> CallHandler <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> map <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;rxjs/operators&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Observable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;rxjs&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">data<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
  data<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Response<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">&gt;</span></span> <span class="token keyword">implements</span> <span class="token class-name">NestInterceptor</span> <span class="token punctuation">{</span>
  <span class="token function">intercept</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> next<span class="token operator">:</span> CallHandler<span class="token punctuation">)</span><span class="token operator">:</span> Observable<span class="token operator">&lt;</span>data<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> next<span class="token punctuation">.</span><span class="token function">handle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
      <span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          data<span class="token punctuation">,</span>
          status<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
          success<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          message<span class="token operator">:</span> <span class="token string">&quot;æˆåŠŸ&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ main.ts æ³¨å†Œ</p><div class="language-vbscript line-numbers-mode" data-ext="vbscript" data-title="vbscript"><pre class="language-vbscript"><code>app.useGlobalInterceptors(new Response())
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="_12ã€nestjs-å¼‚å¸¸æ‹¦æˆªå™¨" tabindex="-1"><a class="header-anchor" href="#_12ã€nestjs-å¼‚å¸¸æ‹¦æˆªå™¨"><span>12ã€nestjs å¼‚å¸¸æ‹¦æˆªå™¨</span></a></h2><p>common ä¸‹é¢æ–°å»º filter.ts</p><p>åˆ›å»ºä¸€ä¸ªå¼‚å¸¸è¿‡æ»¤å™¨ï¼Œå®ƒè´Ÿè´£æ•è·ä½œä¸º HttpException ç±»å®ä¾‹çš„å¼‚å¸¸ï¼Œå¹¶ä¸ºå®ƒä»¬è®¾ç½®è‡ªå®šä¹‰å“åº”é€»è¾‘ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦è®¿é—®åº•å±‚å¹³å° Request å’Œ Responseã€‚æˆ‘ä»¬å°†è®¿é—® Request å¯¹è±¡ï¼Œä»¥ä¾¿æå–åŸå§‹ url å¹¶å°†å…¶åŒ…å«åœ¨æ—¥å¿—ä¿¡æ¯ä¸­ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ Response.json()æ–¹æ³•ï¼Œä½¿ç”¨ Response å¯¹è±¡ç›´æ¥æ§åˆ¶å‘é€çš„å“åº”ã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>
  ExceptionFilter<span class="token punctuation">,</span>
  Catch<span class="token punctuation">,</span>
  ArgumentsHost<span class="token punctuation">,</span>
  HttpException<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Request<span class="token punctuation">,</span> Response <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;express&quot;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Catch</span></span><span class="token punctuation">(</span>HttpException<span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">HttpFilter</span> <span class="token keyword">implements</span> <span class="token class-name">ExceptionFilter</span> <span class="token punctuation">{</span>
  <span class="token function">catch</span><span class="token punctuation">(</span>exception<span class="token operator">:</span> HttpException<span class="token punctuation">,</span> host<span class="token operator">:</span> ArgumentsHost<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> ctx <span class="token operator">=</span> host<span class="token punctuation">.</span><span class="token function">switchToHttp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> request <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">getRequest</span><span class="token generic class-name"><span class="token operator">&lt;</span>Request<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> response <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">getResponse</span><span class="token generic class-name"><span class="token operator">&lt;</span>Response<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> status <span class="token operator">=</span> exception<span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    response<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      data<span class="token operator">:</span> exception<span class="token punctuation">.</span>message<span class="token punctuation">,</span>
      time<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      success<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      path<span class="token operator">:</span> request<span class="token punctuation">.</span>url<span class="token punctuation">,</span>
      status<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨å†Œå…¨å±€å¼‚å¸¸è¿‡æ»¤å™¨</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token comment">// å¼•å…¥å¼‚å¸¸æ‹¦æˆªå™¨</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> HttpFilter <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./common/filter&quot;</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">useGlobalFilters</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_13ã€nestjs-ç®¡é“è½¬æ¢" tabindex="-1"><a class="header-anchor" href="#_13ã€nestjs-ç®¡é“è½¬æ¢"><span>13ã€nestjs ç®¡é“è½¬æ¢</span></a></h2><figure><img src="/my-blob/assets/13.1-si20DVXc.png" alt="13" tabindex="0" loading="lazy"><figcaption>13</figcaption></figure><p>ç®¡é“ å¯ä»¥åšä¸¤ä»¶äº‹</p><p>1.è½¬æ¢ï¼Œå¯ä»¥å°†å‰ç«¯ä¼ å…¥çš„æ•°æ®è½¬æˆæˆæˆ‘ä»¬éœ€è¦çš„æ•°æ®</p><p>2.éªŒè¯ ç±»ä¼¼äºå‰ç«¯çš„ rules é…ç½®éªŒè¯è§„åˆ™</p><p>æˆ‘ä»¬å…ˆæ¥è®²ä¸€ä¸‹è½¬æ¢ Nestjs æä¾›äº†å…«ä¸ªå†…ç½®è½¬æ¢ API</p><ul><li>ValidationPipe</li><li>ParseIntPipe</li><li>ParseFloatPipe</li><li>ParseBoolPipe</li><li>ParseArrayPipe</li><li>ParseUUIDPipe</li><li>ParseEnumPipe</li><li>DefaultValuePipe</li></ul><h3 id="æ¡ˆä¾‹-1-æˆ‘ä»¬æ¥å—çš„åŠ¨æ€å‚æ•°å¸Œæœ›æ˜¯ä¸€ä¸ª-number-ç±»å‹-ç°åœ¨æ˜¯-string" tabindex="-1"><a class="header-anchor" href="#æ¡ˆä¾‹-1-æˆ‘ä»¬æ¥å—çš„åŠ¨æ€å‚æ•°å¸Œæœ›æ˜¯ä¸€ä¸ª-number-ç±»å‹-ç°åœ¨æ˜¯-string"><span>æ¡ˆä¾‹ 1 æˆ‘ä»¬æ¥å—çš„åŠ¨æ€å‚æ•°å¸Œæœ›æ˜¯ä¸€ä¸ª number ç±»å‹ ç°åœ¨æ˜¯ string</span></a></h3><figure><img src="/my-blob/assets/13.2-DtC6mm9N.png" alt="02" tabindex="0" loading="lazy"><figcaption>02</figcaption></figure><figure><img src="/my-blob/assets/13.3-BuzVXavg.png" alt="03" tabindex="0" loading="lazy"><figcaption>03</figcaption></figure><p>è¿™æ—¶å€™å°±å¯ä»¥é€šè¿‡å†…ç½®çš„ç®¡é“ å»åšè½¬æ¢</p><figure><img src="/my-blob/assets/13.4-VMg5_aqe.png" alt="04" tabindex="0" loading="lazy"><figcaption>04</figcaption></figure><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code> <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&#39;:id&#39;</span><span class="token punctuation">)</span>
  <span class="token function">findOne</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Param</span></span><span class="token punctuation">(</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">,</span> ParseIntPipe<span class="token punctuation">)</span> id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// number</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pService<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token operator">+</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ¡ˆä¾‹-2-éªŒè¯-uuid" tabindex="-1"><a class="header-anchor" href="#æ¡ˆä¾‹-2-éªŒè¯-uuid"><span>æ¡ˆä¾‹ 2 éªŒè¯ UUID</span></a></h3><p>å®‰è£… uuid</p><p>npm install uuid -S</p><p>npm install @types/uuid -D</p><p>ç”Ÿæˆä¸€ä¸ª uuid</p><figure><img src="/my-blob/assets/13.5-DNaH-7W9.png" alt="05" tabindex="0" loading="lazy"><figcaption>05</figcaption></figure><h2 id="_14ã€nestjs-ç®¡é“éªŒè¯-dto" tabindex="-1"><a class="header-anchor" href="#_14ã€nestjs-ç®¡é“éªŒè¯-dto"><span>14ã€nestjs ç®¡é“éªŒè¯ DTO</span></a></h2><h3 id="_1-å…ˆåˆ›å»ºä¸€ä¸ª-pipe-éªŒè¯ç®¡é“" tabindex="-1"><a class="header-anchor" href="#_1-å…ˆåˆ›å»ºä¸€ä¸ª-pipe-éªŒè¯ç®¡é“"><span>1.å…ˆåˆ›å»ºä¸€ä¸ª pipe éªŒè¯ç®¡é“</span></a></h3><p><code>nest g pi æ–‡ä»¶åå­—</code></p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> ArgumentMetadata<span class="token punctuation">,</span> Injectable<span class="token punctuation">,</span> PipeTransform <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">LoginPipe</span> <span class="token keyword">implements</span> <span class="token class-name">PipeTransform</span> <span class="token punctuation">{</span>
  <span class="token function">transform</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> metadata<span class="token operator">:</span> ArgumentMetadata<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> metadata<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//{ name: &#39;å¼ ä¸‰&#39; } { metatype: [class CreateLoginDto], type: &#39;body&#39;, data:undefined }</span>
    <span class="token keyword">return</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-å®‰è£…éªŒè¯å™¨" tabindex="-1"><a class="header-anchor" href="#_2-å®‰è£…éªŒè¯å™¨"><span>2.å®‰è£…éªŒè¯å™¨</span></a></h3><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>npm i <span class="token operator">--</span>save <span class="token keyword">class</span><span class="token operator">-</span>validator <span class="token keyword">class</span><span class="token operator">-</span>transformer
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token comment">// create-login.dto.ts</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> IsNotEmpty<span class="token punctuation">,</span> IsString <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;class-validator&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CreatePDto</span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsNotEmpty</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//éªŒè¯æ˜¯å¦ä¸ºç©º</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsString</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//æ˜¯å¦ä¸ºå­—ç¬¦ä¸²</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsNotEmpty</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-controller-ä½¿ç”¨ç®¡é“-å’Œå®šä¹‰ç±»å‹" tabindex="-1"><a class="header-anchor" href="#_3-controller-ä½¿ç”¨ç®¡é“-å’Œå®šä¹‰ç±»å‹"><span>3.controller ä½¿ç”¨ç®¡é“ å’Œå®šä¹‰ç±»å‹</span></a></h3><figure><img src="/my-blob/assets/14.1-CA5MIO8i.png" alt="01" tabindex="0" loading="lazy"><figcaption>01</figcaption></figure><h3 id="_4-å®ç°éªŒè¯-transform" tabindex="-1"><a class="header-anchor" href="#_4-å®ç°éªŒè¯-transform"><span>4.å®ç°éªŒè¯ transform</span></a></h3><figure><img src="/my-blob/assets/14.2-CM46uQjz.png" alt="02" tabindex="0" loading="lazy"><figcaption>02</figcaption></figure><figure><img src="/my-blob/assets/14.3-BiO4qhYf.png" alt="03" tabindex="0" loading="lazy"><figcaption>03</figcaption></figure><figure><img src="/my-blob/assets/14.4-B_LQEJ4x.png" alt="04" tabindex="0" loading="lazy"><figcaption>04</figcaption></figure><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token comment">// login.pipe.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ArgumentMetadata<span class="token punctuation">,</span> Injectable<span class="token punctuation">,</span> PipeTransform <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> plainToInstance <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;class-transformer&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> validate <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;class-validator&quot;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">LoginPipe</span> <span class="token keyword">implements</span> <span class="token class-name">PipeTransform</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">transform</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> metadata<span class="token operator">:</span> ArgumentMetadata<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token constant">DTO</span> <span class="token operator">=</span> <span class="token function">plainToInstance</span><span class="token punctuation">(</span>metadata<span class="token punctuation">.</span>metatype<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">DTO</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//CreateLoginDto { name: &#39;123&#39; }</span>
    <span class="token keyword">const</span> error <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">validate</span><span class="token punctuation">(</span><span class="token constant">DTO</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// [ValidationError {</span>
    <span class="token comment">//    target: CreateLoginDto { name: &#39;123&#39; },</span>
    <span class="token comment">//    value: &#39;123&#39;,</span>
    <span class="token comment">//    property: &#39;name&#39;,</span>
    <span class="token comment">//    children: [],</span>
    <span class="token comment">//    constraints: { isLength: &#39;é•¿åº¦ä¸º5-10ä½&#39; }</span>
    <span class="token comment">//  }</span>
    <span class="token comment">// ]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">HttpException</span><span class="token punctuation">(</span>error<span class="token punctuation">,</span> HttpStatus<span class="token punctuation">.</span><span class="token constant">BAD_REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-æ³¨å†Œå…¨å±€-dto-éªŒè¯ç®¡é“" tabindex="-1"><a class="header-anchor" href="#_5-æ³¨å†Œå…¨å±€-dto-éªŒè¯ç®¡é“"><span>5.æ³¨å†Œå…¨å±€ DTO éªŒè¯ç®¡é“</span></a></h3><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token comment">// main.ts</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> NestFactory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/core&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> AppModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./app.module&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// é…ç½®é™æ€è®¿é—®çš„è·¯ç”±</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> NestExpressApplication <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/platform-express&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> join <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;path&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// å¼•å…¥å“åº”æ‹¦æˆªå™¨</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Response <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./common/response&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// å¼•å…¥å¼‚å¸¸æ‹¦æˆªå™¨</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> HttpFilter <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./common/filter&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// å¼•å…¥å…¨å±€éªŒè¯</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ValidationPipe <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">await</span> NestFactory<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">create</span><span class="token generic class-name"><span class="token operator">&lt;</span>NestExpressApplication<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>AppModule<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// æ³¨å†Œå…¨å±€å“åº”æ‹¦æˆªå™¨</span>
  app<span class="token punctuation">.</span><span class="token function">useGlobalInterceptors</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// æ³¨å†Œå…¨å±€å¼‚å¸¸è¿‡æ»¤å™¨</span>
  app<span class="token punctuation">.</span><span class="token function">useGlobalFilters</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  app<span class="token punctuation">.</span><span class="token function">useStaticAssets</span><span class="token punctuation">(</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;images&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    prefix<span class="token operator">:</span> <span class="token string">&quot;/images&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  app<span class="token punctuation">.</span><span class="token function">useGlobalPipes</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ValidationPipe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_15ã€nestjs-çˆ¬è™«" tabindex="-1"><a class="header-anchor" href="#_15ã€nestjs-çˆ¬è™«"><span>15ã€nestjs çˆ¬è™«</span></a></h2><p>å…¶å®çˆ¬è™«æ˜¯ä¸€ä¸ªå¯¹è®¡ç®—æœºç»¼åˆèƒ½åŠ›è¦æ±‚æ¯”è¾ƒé«˜çš„æŠ€æœ¯æ´»ã€‚</p><p>é¦–å…ˆæ˜¯è¦å¯¹ç½‘ç»œåè®®å°¤å…¶æ˜¯ http åè®®æœ‰åŸºæœ¬çš„äº†è§£, èƒ½å¤Ÿåˆ†æç½‘ç«™çš„æ•°æ®è¯·æ±‚å“åº”ã€‚å­¦ä¼šä½¿ç”¨ä¸€äº›å·¥å…·ï¼Œç®€å•çš„æƒ…å†µä½¿ç”¨ chrome devtools çš„ network é¢æ¿å°±å¤Ÿäº†</p><ul><li>cheerio: æ˜¯ jquery æ ¸å¿ƒåŠŸèƒ½çš„ä¸€ä¸ªå¿«é€Ÿçµæ´»è€Œåˆç®€æ´çš„å®ç°ï¼Œä¸»è¦æ˜¯ä¸ºäº†ç”¨åœ¨æœåŠ¡å™¨ç«¯éœ€è¦å¯¹ DOM è¿›è¡Œæ“ä½œçš„åœ°æ–¹ï¼Œè®©ä½ åœ¨æœåŠ¡å™¨ç«¯å’Œ html æ„‰å¿«çš„ç©è€ã€‚</li><li>axios ç½‘ç»œè¯·æ±‚åº“å¯ä»¥å‘é€ http è¯·æ±‚</li></ul><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">&quot;axios&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> cheerio <span class="token keyword">from</span> <span class="token string">&quot;cheerio&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> fs <span class="token keyword">from</span> <span class="token string">&quot;fs&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> path <span class="token keyword">from</span> <span class="token string">&quot;path&quot;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">SpiderService</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> urlList<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token function-variable function">getCosPlay</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> body <span class="token operator">=</span> <span class="token keyword">await</span> axios
        <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;https://www.yeitu.com/dongman/cosplay/20160416_10878.html&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> $ <span class="token operator">=</span> cheerio<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;.article-body a img&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        urlList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&quot;src&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> <span class="token function">getCosPlay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>urlList<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span>urlList<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">&quot;cos&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// å†™å…¥æœ¬åœ°</span>
  <span class="token function">writeFile</span><span class="token punctuation">(</span>urls<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    urls<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> buffer <span class="token operator">=</span> <span class="token keyword">await</span> axios
        <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span> responseType<span class="token operator">:</span> <span class="token string">&quot;arraybuffer&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> ws <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span>
        path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../images/cos&quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;.jpg&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      ws<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_16ã€nestjs-è¿æ¥æ•°æ®åº“" tabindex="-1"><a class="header-anchor" href="#_16ã€nestjs-è¿æ¥æ•°æ®åº“"><span>16ã€nestjs è¿æ¥æ•°æ®åº“</span></a></h2><h4 id="orm-æ¡†æ¶-typeorm" tabindex="-1"><a class="header-anchor" href="#orm-æ¡†æ¶-typeorm"><span>ORM æ¡†æ¶ï¼ˆtypeOrmï¼‰</span></a></h4><p>typeOrm æ˜¯ <code>TypeScript</code> ä¸­æœ€æˆç†Ÿçš„å¯¹è±¡å…³ç³»æ˜ å°„å™¨( <code>ORM</code> )ã€‚å› ä¸ºå®ƒæ˜¯ç”¨ <code>TypeScript</code> ç¼–å†™çš„ï¼Œæ‰€ä»¥å¯ä»¥å¾ˆå¥½åœ°ä¸ <code>Nest</code> æ¡†æ¶é›†æˆ</p><h5 id="å®‰è£…ä¾èµ–" tabindex="-1"><a class="header-anchor" href="#å®‰è£…ä¾èµ–"><span>å®‰è£…ä¾èµ–</span></a></h5><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>npm install --save @nestjs/typeorm typeorm mysql2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="å¦‚æœä½¿ç”¨çš„æ˜¯-vscode-å®‰è£…æ•°æ®åº“å¯è§†åŒ–å·¥å…·" tabindex="-1"><a class="header-anchor" href="#å¦‚æœä½¿ç”¨çš„æ˜¯-vscode-å®‰è£…æ•°æ®åº“å¯è§†åŒ–å·¥å…·"><span>å¦‚æœä½¿ç”¨çš„æ˜¯ vsCode å®‰è£…æ•°æ®åº“å¯è§†åŒ–å·¥å…·</span></a></h5><figure><img src="/my-blob/assets/16-1-1EZIAwP0.png" alt="image-20240321102503591" tabindex="0" loading="lazy"><figcaption>image-20240321102503591</figcaption></figure><h5 id="åœ¨-app-module-ts-æ³¨å†Œ" tabindex="-1"><a class="header-anchor" href="#åœ¨-app-module-ts-æ³¨å†Œ"><span>åœ¨ app.module.ts æ³¨å†Œ</span></a></h5><figure><img src="/my-blob/assets/16-2-xuq9YViS.png" alt="image-20240321102503592" tabindex="0" loading="lazy"><figcaption>image-20240321102503592</figcaption></figure><h5 id="å®šä¹‰å®ä½“" tabindex="-1"><a class="header-anchor" href="#å®šä¹‰å®ä½“"><span>å®šä¹‰å®ä½“</span></a></h5><figure><img src="/my-blob/assets/16-3-DC_AkCNz.png" alt="image-20240321102503593" tabindex="0" loading="lazy"><figcaption>image-20240321102503593</figcaption></figure><h5 id="å…³è”å®ä½“" tabindex="-1"><a class="header-anchor" href="#å…³è”å®ä½“"><span>å…³è”å®ä½“</span></a></h5><figure><img src="/my-blob/assets/16-4-BluBEFF-.png" alt="image-20240321102503594" tabindex="0" loading="lazy"><figcaption>image-20240321102503594</figcaption></figure><h2 id="_17ã€nestjs-å®ä½“" tabindex="-1"><a class="header-anchor" href="#_17ã€nestjs-å®ä½“"><span>17ã€nestjs å®ä½“</span></a></h2><blockquote><p>ä»€ä¹ˆæ˜¯å®ä½“</p></blockquote><blockquote><p>å®ä½“æ˜¯ä¸€ä¸ªæ˜ å°„åˆ°æ•°æ®åº“è¡¨çš„ç±»ã€‚ ä½ å¯ä»¥é€šè¿‡å®šä¹‰ä¸€ä¸ªæ–°ç±»æ¥åˆ›å»ºä¸€ä¸ªå®ä½“ï¼Œå¹¶ç”¨<code>@Entity()</code>æ¥æ ‡è®°ï¼š</p></blockquote><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Entity<span class="token punctuation">,</span> Column<span class="token punctuation">,</span> PrimaryGeneratedColumn <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;typeorm&quot;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">PrimaryGeneratedColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  password<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="åˆ—ç±»å‹" tabindex="-1"><a class="header-anchor" href="#åˆ—ç±»å‹"><span>åˆ—ç±»å‹</span></a></h4><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span><span class="token string">&quot;varchar&quot;</span><span class="token punctuation">,</span>length<span class="token operator">:</span><span class="token number">200</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
password<span class="token operator">:</span> <span class="token builtin">string</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&quot;int&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
age<span class="token operator">:</span> <span class="token builtin">number</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">CreateDateColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span><span class="token string">&quot;timestamp&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
create_time<span class="token operator">:</span>Date
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>mysql æ‰€æœ‰ç±»å‹</p><p><code>int, tinyint, smallint, mediumint, bigint, float, double, dec, decimal, numeric, date, datetime, timestamp, time, year, char, varchar, nvarchar, text, tinytext, mediumtext, blob, longtext, tinyblob, mediumblob, longblob, enum, json, binary, geometry, point, linestring, polygon, multipoint, multilinestring, multipolygon, geometrycollection</code></p><h4 id="è‡ªåŠ¨ç”Ÿæˆåˆ—" tabindex="-1"><a class="header-anchor" href="#è‡ªåŠ¨ç”Ÿæˆåˆ—"><span>è‡ªåŠ¨ç”Ÿæˆåˆ—</span></a></h4><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Generated</span></span><span class="token punctuation">(</span><span class="token string">&#39;uuid&#39;</span><span class="token punctuation">)</span>
uuid<span class="token operator">:</span><span class="token builtin">string</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æšä¸¾åˆ—" tabindex="-1"><a class="header-anchor" href="#æšä¸¾åˆ—"><span>æšä¸¾åˆ—</span></a></h4><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code>  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    type<span class="token operator">:</span><span class="token string">&quot;enum&quot;</span><span class="token punctuation">,</span>
    <span class="token keyword">enum</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;2&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;3&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;4&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token operator">:</span><span class="token string">&#39;1&#39;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  xx<span class="token operator">:</span><span class="token builtin">string</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="åˆ—é€‰é¡¹" tabindex="-1"><a class="header-anchor" href="#åˆ—é€‰é¡¹"><span>åˆ—é€‰é¡¹</span></a></h4><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    type<span class="token operator">:</span><span class="token string">&quot;varchar&quot;</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span><span class="token string">&quot;ipaaa&quot;</span><span class="token punctuation">,</span> <span class="token comment">//æ•°æ®åº“è¡¨ä¸­çš„åˆ—å</span>
    nullable<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//åœ¨æ•°æ®åº“ä¸­ä½¿åˆ—NULLæˆ–NOT NULLã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œåˆ—æ˜¯nullableï¼šfalse</span>
    comment<span class="token operator">:</span><span class="token string">&quot;æ³¨é‡Š&quot;</span><span class="token punctuation">,</span>
    select<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token comment">//å®šä¹‰åœ¨è¿›è¡ŒæŸ¥è¯¢æ—¶æ˜¯å¦é»˜è®¤éšè—æ­¤åˆ—ã€‚ è®¾ç½®ä¸ºfalseæ—¶ï¼Œåˆ—æ•°æ®ä¸ä¼šæ˜¾ç¤ºæ ‡å‡†æŸ¥è¯¢ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œåˆ—æ˜¯selectï¼štrue</span>
    <span class="token keyword">default</span><span class="token operator">:</span><span class="token string">&quot;xxxx&quot;</span><span class="token punctuation">,</span> <span class="token comment">//åŠ æ•°æ®åº“çº§åˆ—çš„DEFAULTå€¼</span>
    primary<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//å°†åˆ—æ ‡è®°ä¸ºä¸»è¦åˆ—ã€‚ ä½¿ç”¨æ–¹å¼å’Œ@ PrimaryColumnç›¸åŒã€‚</span>
    update<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//æŒ‡ç¤º&quot;save&quot;æ“ä½œæ˜¯å¦æ›´æ–°åˆ—å€¼ã€‚å¦‚æœä¸ºfalseï¼Œåˆ™åªèƒ½åœ¨ç¬¬ä¸€æ¬¡æ’å…¥å¯¹è±¡æ—¶ç¼–å†™è¯¥å€¼ã€‚ é»˜è®¤å€¼ä¸º&quot;true&quot;</span>
    collation<span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token comment">//å®šä¹‰åˆ—æ’åºè§„åˆ™ã€‚</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
ip<span class="token operator">:</span><span class="token builtin">string</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ColumnOptions ä¸­å¯ç”¨é€‰é¡¹åˆ—è¡¨ï¼š</p><ul><li>type: ColumnType - åˆ—ç±»å‹ã€‚å…¶ä¸­ä¹‹ä¸€åœ¨ä¸Šé¢.</li><li>name: string - æ•°æ®åº“è¡¨ä¸­çš„åˆ—åã€‚<br> é»˜è®¤æƒ…å†µä¸‹ï¼Œåˆ—åç§°æ˜¯ä»å±æ€§çš„åç§°ç”Ÿæˆçš„ã€‚ ä½ ä¹Ÿå¯ä»¥é€šè¿‡æŒ‡å®šè‡ªå·±çš„åç§°æ¥æ›´æ”¹å®ƒã€‚</li><li>length: number - åˆ—ç±»å‹çš„é•¿åº¦ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœè¦åˆ›å»º varcharï¼ˆ150ï¼‰ç±»å‹ï¼Œè¯·æŒ‡å®šåˆ—ç±»å‹å’Œé•¿åº¦é€‰é¡¹ã€‚</li><li>width: number - åˆ—ç±»å‹çš„æ˜¾ç¤ºèŒƒå›´ã€‚ ä»…ç”¨äº MySQL integer types(opens new window)</li><li>onUpdate: string - ON UPDATE è§¦å‘å™¨ã€‚ ä»…ç”¨äº MySQL (opens new window).</li><li>nullable: boolean - åœ¨æ•°æ®åº“ä¸­ä½¿åˆ— NULL æˆ– NOT NULLã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œåˆ—æ˜¯ nullableï¼šfalseã€‚</li><li>update: boolean - æŒ‡ç¤º&quot;save&quot;æ“ä½œæ˜¯å¦æ›´æ–°åˆ—å€¼ã€‚å¦‚æœä¸º falseï¼Œåˆ™åªèƒ½åœ¨ç¬¬ä¸€æ¬¡æ’å…¥å¯¹è±¡æ—¶ç¼–å†™è¯¥å€¼ã€‚ é»˜è®¤å€¼ä¸º&quot;true&quot;ã€‚</li><li>select: boolean - å®šä¹‰åœ¨è¿›è¡ŒæŸ¥è¯¢æ—¶æ˜¯å¦é»˜è®¤éšè—æ­¤åˆ—ã€‚ è®¾ç½®ä¸º false æ—¶ï¼Œåˆ—æ•°æ®ä¸ä¼šæ˜¾ç¤ºæ ‡å‡†æŸ¥è¯¢ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œåˆ—æ˜¯ selectï¼štrue</li><li>default: string - æ·»åŠ æ•°æ®åº“çº§åˆ—çš„ DEFAULT å€¼ã€‚</li><li>primary: boolean - å°†åˆ—æ ‡è®°ä¸ºä¸»è¦åˆ—ã€‚ ä½¿ç”¨æ–¹å¼å’Œ@ PrimaryColumn ç›¸åŒã€‚</li><li>unique: boolean - å°†åˆ—æ ‡è®°ä¸ºå”¯ä¸€åˆ—ï¼ˆåˆ›å»ºå”¯ä¸€çº¦æŸï¼‰ã€‚</li><li>comment: string - æ•°æ®åº“åˆ—å¤‡æ³¨ï¼Œå¹¶éæ‰€æœ‰æ•°æ®åº“ç±»å‹éƒ½æ”¯æŒã€‚</li><li>precision: number - åè¿›åˆ¶ï¼ˆç²¾ç¡®æ•°å­—ï¼‰åˆ—çš„ç²¾åº¦ï¼ˆä»…é€‚ç”¨äºåè¿›åˆ¶åˆ—ï¼‰ï¼Œè¿™æ˜¯ä¸ºå€¼å­˜å‚¨çš„æœ€å¤§ä½æ•°ã€‚ä»…ç”¨äºæŸäº›åˆ—ç±»å‹ã€‚</li><li>scale: number - åè¿›åˆ¶ï¼ˆç²¾ç¡®æ•°å­—ï¼‰åˆ—çš„æ¯”ä¾‹ï¼ˆä»…é€‚ç”¨äºåè¿›åˆ¶åˆ—ï¼‰ï¼Œè¡¨ç¤ºå°æ•°ç‚¹å³ä¾§çš„ä½æ•°ï¼Œä¸”ä¸å¾—å¤§äºç²¾åº¦ã€‚ ä»…ç”¨äºæŸäº›åˆ—ç±»å‹ã€‚</li><li>zerofill: boolean - å°† ZEROFILL å±æ€§è®¾ç½®ä¸ºæ•°å­—åˆ—ã€‚ ä»…åœ¨ MySQL ä¸­ä½¿ç”¨ã€‚ å¦‚æœæ˜¯ trueï¼ŒMySQL ä¼šè‡ªåŠ¨å°† UNSIGNED å±æ€§æ·»åŠ åˆ°æ­¤åˆ—ã€‚</li><li>unsigned: boolean - å°† UNSIGNED å±æ€§è®¾ç½®ä¸ºæ•°å­—åˆ—ã€‚ ä»…åœ¨ MySQL ä¸­ä½¿ç”¨ã€‚</li><li>charset: string - å®šä¹‰åˆ—å­—ç¬¦é›†ã€‚ å¹¶éæ‰€æœ‰æ•°æ®åº“ç±»å‹éƒ½æ”¯æŒã€‚</li><li>collation: string - å®šä¹‰åˆ—æ’åºè§„åˆ™ã€‚</li><li>enum: string[]|AnyEnum - åœ¨ enum åˆ—ç±»å‹ä¸­ä½¿ç”¨ï¼Œä»¥æŒ‡å®šå…è®¸çš„æšä¸¾å€¼åˆ—è¡¨ã€‚ ä½ ä¹Ÿå¯ä»¥æŒ‡å®šæ•°ç»„æˆ–æŒ‡å®šæšä¸¾ç±»ã€‚</li><li>asExpression: string - ç”Ÿæˆçš„åˆ—è¡¨è¾¾å¼ã€‚ ä»…åœ¨ MySQL (opens new window)ä¸­ä½¿ç”¨ã€‚</li><li>generatedType: &quot;VIRTUAL&quot;|&quot;STORED&quot; - ç”Ÿæˆçš„åˆ—ç±»å‹ã€‚ ä»…åœ¨ MySQL (opens new window)ä¸­ä½¿ç”¨ã€‚</li><li>hstoreType: &quot;object&quot;|&quot;string&quot; -è¿”å› HSTORE åˆ—ç±»å‹ã€‚ ä»¥å­—ç¬¦ä¸²æˆ–å¯¹è±¡çš„å½¢å¼è¿”å›å€¼ã€‚ ä»…åœ¨ Postgres ä¸­ä½¿ç”¨ã€‚</li><li>array: boolean - ç”¨äºå¯ä»¥æ˜¯æ•°ç»„çš„ postgres åˆ—ç±»å‹ï¼ˆä¾‹å¦‚ int []ï¼‰</li><li>transformer: { from(value: DatabaseType): EntityType, to(value: EntityType): DatabaseType } - ç”¨äºå°†ä»»æ„ç±»å‹ EntityType çš„å±æ€§ç¼–ç»„ä¸ºæ•°æ®åº“æ”¯æŒçš„ç±»å‹ DatabaseTypeã€‚</li></ul><h4 id="simple-array-åˆ—ç±»å‹" tabindex="-1"><a class="header-anchor" href="#simple-array-åˆ—ç±»å‹"><span>simple-array åˆ—ç±»å‹</span></a></h4><blockquote><p>æœ‰ä¸€ç§ç§°ä¸º<code>simple-array</code>çš„ç‰¹æ®Šåˆ—ç±»å‹ï¼Œå®ƒå¯ä»¥å°†åŸå§‹æ•°ç»„å€¼å­˜å‚¨åœ¨å•ä¸ªå­—ç¬¦ä¸²åˆ—ä¸­ã€‚ æ‰€æœ‰å€¼éƒ½ä»¥é€—å·åˆ†éš”</p></blockquote><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">PrimaryGeneratedColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token string">&quot;simple-array&quot;</span><span class="token punctuation">)</span>
  names<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="simple-json-åˆ—ç±»å‹" tabindex="-1"><a class="header-anchor" href="#simple-json-åˆ—ç±»å‹"><span>simple-json åˆ—ç±»å‹</span></a></h4><p>è¿˜æœ‰ä¸€ä¸ªåä¸º<code>simple-json</code>çš„ç‰¹æ®Šåˆ—ç±»å‹ï¼Œå®ƒå¯ä»¥å­˜å‚¨ä»»ä½•å¯ä»¥é€šè¿‡ JSON.stringify å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„å€¼ã€‚ å½“ä½ çš„æ•°æ®åº“ä¸­æ²¡æœ‰ json ç±»å‹è€Œä½ åˆæƒ³å­˜å‚¨å’ŒåŠ è½½å¯¹è±¡ï¼Œè¯¥ç±»å‹å°±å¾ˆæœ‰ç”¨äº†ã€‚ ä¾‹å¦‚</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">PrimaryGeneratedColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token string">&quot;simple-json&quot;</span><span class="token punctuation">)</span>
  profile<span class="token operator">:</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> nickname<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="vp-link vp-external-link-icon vp-meta-label" href="https://github.com/vuepress-theme-hope/vuepress-theme-hope/edit/main/src/category/Nest/NestJS.md" rel="noopener noreferrer" target="_blank" aria-label="åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: 2412205377@qq.com">DJ</span><!--]--><!--]--></div></div></footer><!----><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">é»˜è®¤é¡µè„š</div><div class="vp-copyright">Copyright Â© 2024 æœˆå²› </div></footer></div><!--]--><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/my-blob/assets/app-CEy8En57.js" defer></script>
  </body>
</html>
